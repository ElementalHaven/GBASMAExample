{"names":["UpdateBattleStateAndExperienceAfterEnemyFaint"],"callingMethods":["HandleEnemyMonFaint","HandlePlayerMonFaint"],"methodsCalled":["BreakAttraction","CheckPlayerPartyForFitMon","CopyBytes","EmptyBattleTextbox","GetPartyLocation","GiveExperiencePoints","IsAnyMonHoldingExpShare","LoadTilemapToTempTilemap","NewEnemyMonStatus","PlayVictoryMusic","StopDangerSound","UpdateBattleMonInParty","UpdateFaintedPlayerMon"],"methodAddressesUsed":[],"varsSet":["wBattleLowHealthAlarm","wBattleParticipantsNotFainted","wBattleResult","wGivingExperienceToExpShareHolders"],"varsUsed":["wBattleMode","wBattleParticipantsNotFainted","wBattleResult","wCurOTMon","wWhichMonFaintedFirst"],"varAddressesUsed":["wBackupEnemyMonBaseStats","wBattleMonHP","wEnemyDamageTaken","wEnemyMonBaseStats","wOTPartyMon1HP","wPlayerSubStatus3"],"constantsUsed":[],"lines":["UpdateBattleStateAndExperienceAfterEnemyFaint:","\tcall UpdateBattleMonInParty","\tld a, [wBattleMode]","\tdec a","\tjr z, .wild","\tld a, [wCurOTMon]","\tld hl, wOTPartyMon1HP","\tcall GetPartyLocation","\txor a","\tld [hli], a","\tld [hl], a","",".wild","\tld hl, wPlayerSubStatus3","\tres SUBSTATUS_IN_LOOP, [hl]","\txor a","\tld hl, wEnemyDamageTaken","\tld [hli], a","\tld [hl], a","\tcall NewEnemyMonStatus","\tcall BreakAttraction","\tld a, [wBattleMode]","\tdec a","\tjr z, .wild2","\tjr .trainer","",".wild2","\tcall StopDangerSound","\tld a, $1","\tld [wBattleLowHealthAlarm], a","",".trainer","\tld hl, wBattleMonHP","\tld a, [hli]","\tor [hl]","\tjr nz, .player_mon_did_not_faint","\tld a, [wWhichMonFaintedFirst]","\tand a","\tjr nz, .player_mon_did_not_faint","\tcall UpdateFaintedPlayerMon","",".player_mon_did_not_faint","\tcall CheckPlayerPartyForFitMon","\tld a, d","\tand a","\tret z","\tld a, [wBattleMode]","\tdec a","\tcall z, PlayVictoryMusic","\tcall EmptyBattleTextbox","\tcall LoadTilemapToTempTilemap","\tld a, [wBattleResult]","\tand BATTLERESULT_BITMASK","\tld [wBattleResult], a ; WIN","\tcall IsAnyMonHoldingExpShare","\tjr z, .skip_exp","\tld hl, wEnemyMonBaseStats","\tld b, wEnemyMonEnd - wEnemyMonBaseStats",".loop","\tsrl [hl]","\tinc hl","\tdec b","\tjr nz, .loop","",".skip_exp","\tld hl, wEnemyMonBaseStats","\tld de, wBackupEnemyMonBaseStats","\tld bc, wEnemyMonEnd - wEnemyMonBaseStats","\tcall CopyBytes","\txor a","\tld [wGivingExperienceToExpShareHolders], a","\tcall GiveExperiencePoints","\tcall IsAnyMonHoldingExpShare","\tret z","","\tld a, [wBattleParticipantsNotFainted]","\tpush af","\tld a, d","\tld [wBattleParticipantsNotFainted], a","\tld hl, wBackupEnemyMonBaseStats","\tld de, wEnemyMonBaseStats","\tld bc, wEnemyMonEnd - wEnemyMonBaseStats","\tcall CopyBytes","\tld a, $1","\tld [wGivingExperienceToExpShareHolders], a","\tcall GiveExperiencePoints","\tpop af","\tld [wBattleParticipantsNotFainted], a","\tret"],"name":"UpdateBattleStateAndExperienceAfterEnemyFaint","file":"engine/battle/core.asm","lineNo":2095,"address":135764,"addressUsedBy":[]}