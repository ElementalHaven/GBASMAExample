{"names":["LinkTradeMenu"],"callingMethods":[],"methodsCalled":["AddNTimes","Coord2Tile","FarCall","JoyTextDelay","UpdateTimeAndPals","WaitBGMap"],"methodAddressesUsed":["PlaySpriteAnimationsAndDelayFrame","_2DMenuInterpretJoypad"],"varsSet":["hBGMapMode","hOAMUpdate","wCursorCurrentTile","wCursorOffCharacter"],"varsUsed":["hBGMapMode","hJoyLast","hJoyPressed","hOAMUpdate","w2DMenuCursorInitX","w2DMenuCursorInitY","w2DMenuCursorOffsets","w2DMenuFlags1","wCursorOffCharacter","wMenuCursorX","wMenuCursorY","wMenuJoypadFilter"],"varAddressesUsed":["w2DMenuFlags2","wCursorCurrentTile"],"constantsUsed":["MON_NAME_LENGTH","SCREEN_WIDTH"],"lines":["LinkTradeMenu:","\tcall .MenuAction","\tcall .GetJoypad","\tret","",".GetJoypad:","\tpush bc","\tpush af","\tldh a, [hJoyLast]","\tand D_PAD","\tld b, a","\tldh a, [hJoyPressed]","\tand BUTTONS","\tor b","\tld b, a","\tpop af","\tld a, b","\tpop bc","\tld d, a","\tret","",".MenuAction:","\tld hl, w2DMenuFlags2","\tres 7, [hl]","\tldh a, [hBGMapMode]","\tpush af","\tcall .loop","\tpop af","\tldh [hBGMapMode], a","\tret","",".loop","\tcall .UpdateCursor","\tcall .UpdateBGMapAndOAM","\tcall .loop2","\tjr nc, .done","\tfarcall _2DMenuInterpretJoypad","\tjr c, .done","\tld a, [w2DMenuFlags1]","\tbit 7, a","\tjr nz, .done","\tcall .GetJoypad","\tld b, a","\tld a, [wMenuJoypadFilter]","\tand b","\tjr z, .loop","",".done","\tret","",".UpdateBGMapAndOAM:","\tldh a, [hOAMUpdate]","\tpush af","\tld a, $1","\tldh [hOAMUpdate], a","\tcall WaitBGMap","\tpop af","\tldh [hOAMUpdate], a","\txor a","\tldh [hBGMapMode], a","\tret","",".loop2","\tcall UpdateTimeAndPals","\tcall .TryAnims","\tret c","\tld a, [w2DMenuFlags1]","\tbit 7, a","\tjr z, .loop2","\tand a","\tret","",".UpdateCursor:","\tld hl, wCursorCurrentTile","\tld a, [hli]","\tld h, [hl]","\tld l, a","\tld a, [hl]","\tcp $1f","\tjr nz, .not_currently_selected","\tld a, [wCursorOffCharacter]","\tld [hl], a","\tpush hl","\tpush bc","\tld bc, MON_NAME_LENGTH","\tadd hl, bc","\tld [hl], a","\tpop bc","\tpop hl","",".not_currently_selected","\tld a, [w2DMenuCursorInitY]","\tld b, a","\tld a, [w2DMenuCursorInitX]","\tld c, a","\tcall Coord2Tile","\tld a, [w2DMenuCursorOffsets]","\tswap a","\tand $f","\tld c, a","\tld a, [wMenuCursorY]","\tld b, a","\txor a","\tdec b","\tjr z, .skip",".loop3","\tadd c","\tdec b","\tjr nz, .loop3","",".skip","\tld c, SCREEN_WIDTH","\tcall AddNTimes","\tld a, [w2DMenuCursorOffsets]","\tand $f","\tld c, a","\tld a, [wMenuCursorX]","\tld b, a","\txor a","\tdec b","\tjr z, .skip2",".loop4","\tadd c","\tdec b","\tjr nz, .loop4","",".skip2","\tld c, a","\tadd hl, bc","\tld a, [hl]","\tcp $1f","\tjr z, .cursor_already_there","\tld [wCursorOffCharacter], a","\tld [hl], $1f","\tpush hl","\tpush bc","\tld bc, MON_NAME_LENGTH","\tadd hl, bc","\tld [hl], $1f","\tpop bc","\tpop hl",".cursor_already_there","\tld a, l","\tld [wCursorCurrentTile], a","\tld a, h","\tld [wCursorCurrentTile + 1], a","\tret","",".TryAnims:","\tld a, [w2DMenuFlags1]","\tbit 6, a","\tjr z, .skip_anims","\tfarcall PlaySpriteAnimationsAndDelayFrame",".skip_anims","\tcall JoyTextDelay","\tcall .GetJoypad","\tand a","\tret z","\tscf","\tret"],"name":"LinkTradeMenu","file":"engine/link/link_trade.asm","lineNo":180,"address":293563,"addressUsedBy":["LinkTradePartymonMenuLoop","LinkTradeOTPartymonMenuLoop"]}