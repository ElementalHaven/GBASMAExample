{"names":["DoPlayerDamage"],"callingMethods":["BattleCommand_ApplyDamage","GetFailureResultText","HitConfusion"],"methodsCalled":["DoSubstituteDamage","Predef","RefreshBattleHuds"],"methodAddressesUsed":[],"varsSet":["wBattleMonHP","wBuffer1","wBuffer2","wBuffer3","wBuffer4","wBuffer5","wBuffer6","wWhichHPBar"],"varsUsed":["wBattleMonHP","wBuffer3","wBuffer4","wPlayerSubStatus4"],"varAddressesUsed":["AnimateHPBarPredef","wBattleMonHP","wBattleMonMaxHP","wBuffer5","wCurDamage"],"constantsUsed":[],"lines":["DoPlayerDamage:","\tld hl, wCurDamage","\tld a, [hli]","\tld b, a","\tld a, [hl]","\tor b","\tjr z, .did_no_damage","","\tld a, c","\tand a","\tjr nz, .ignore_substitute","\tld a, [wPlayerSubStatus4]","\tbit SUBSTATUS_SUBSTITUTE, a","\tjp nz, DoSubstituteDamage","",".ignore_substitute","\t; Substract wCurDamage from wBattleMonHP.","\t;  store original HP in little endian wBuffer3/4","\t;  store new HP in little endian wBuffer5/6","\tld a, [hld]","\tld b, a","\tld a, [wBattleMonHP + 1]","\tld [wBuffer3], a","\tsub b","\tld [wBattleMonHP + 1], a","\tld [wBuffer5], a","\tld b, [hl]","\tld a, [wBattleMonHP]","\tld [wBuffer4], a","\tsbc b","\tld [wBattleMonHP], a","\tld [wBuffer6], a","\tjr nc, .no_underflow","","\tld a, [wBuffer4]","\tld [hli], a","\tld a, [wBuffer3]","\tld [hl], a","\txor a","\tld hl, wBattleMonHP","\tld [hli], a","\tld [hl], a","\tld hl, wBuffer5","\tld [hli], a","\tld [hl], a","",".no_underflow","\tld hl, wBattleMonMaxHP","\tld a, [hli]","\tld [wBuffer2], a","\tld a, [hl]","\tld [wBuffer1], a","","\thlcoord 10, 9","\tld a, 1","\tld [wWhichHPBar], a","\tpredef AnimateHPBar",".did_no_damage","\tjp RefreshBattleHuds"],"name":"DoPlayerDamage","file":"engine/battle/effect_commands.asm","lineNo":3463,"address":120238,"addressUsedBy":[]}