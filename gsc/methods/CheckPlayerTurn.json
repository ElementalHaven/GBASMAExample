{"names":["CheckPlayerTurn"],"callingMethods":["BattleCommand_CheckTurn","CheckTurn"],"methodsCalled":["BattleRandom","CallBattleCore","CantMove","EndTurn","FarPlayBattleAnimation","HitConfusion","MoveDisabled","StdBattleTextbox","UpdateBattleMonInParty"],"methodAddressesUsed":["UpdatePlayerHUD"],"varsSet":["hBGMapMode","wBattleMonStatus","wDisabledMove","wNumHits"],"varsUsed":["wCurPlayerMove","wDisabledMove","wPlayerSubStatus1","wPlayerSubStatus3"],"varAddressesUsed":["wBattleMonStatus","wCurPlayerMove","wPlayerConfuseCount","wPlayerDisableCount","wPlayerSubStatus1","wPlayerSubStatus3","wPlayerSubStatus4"],"constantsUsed":["ANIM_CONFUSED","ANIM_IN_LOVE","ANIM_SLP"],"lines":["CheckPlayerTurn:","\tld hl, wPlayerSubStatus4","\tbit SUBSTATUS_RECHARGE, [hl]","\tjr z, .no_recharge","","\tres SUBSTATUS_RECHARGE, [hl]","\tld hl, MustRechargeText","\tcall StdBattleTextbox","\tcall CantMove","\tjp EndTurn","",".no_recharge","","\tld hl, wBattleMonStatus","\tld a, [hl]","\tand SLP","\tjr z, .not_asleep","","\tdec a","\tld [wBattleMonStatus], a","\tand SLP","\tjr z, .woke_up","","\txor a","\tld [wNumHits], a","\tld de, ANIM_SLP","\tcall FarPlayBattleAnimation","\tjr .fast_asleep","",".woke_up","\tld hl, WokeUpText","\tcall StdBattleTextbox","\tcall CantMove","\tcall UpdateBattleMonInParty","\tld hl, UpdatePlayerHUD","\tcall CallBattleCore","\tld a, $1","\tldh [hBGMapMode], a","\tld hl, wPlayerSubStatus1","\tres SUBSTATUS_NIGHTMARE, [hl]","\tjr .not_asleep","",".fast_asleep","\tld hl, FastAsleepText","\tcall StdBattleTextbox","","\t; Snore and Sleep Talk bypass sleep.","\tld a, [wCurPlayerMove]","\tcp SNORE","\tjr z, .not_asleep","\tcp SLEEP_TALK","\tjr z, .not_asleep","","\tcall CantMove","\tjp EndTurn","",".not_asleep","","\tld hl, wBattleMonStatus","\tbit FRZ, [hl]","\tjr z, .not_frozen","","\t; Flame Wheel and Sacred Fire thaw the user.","\tld a, [wCurPlayerMove]","\tcp FLAME_WHEEL","\tjr z, .not_frozen","\tcp SACRED_FIRE","\tjr z, .not_frozen","","\tld hl, FrozenSolidText","\tcall StdBattleTextbox","","\tcall CantMove","\tjp EndTurn","",".not_frozen","","\tld hl, wPlayerSubStatus3","\tbit SUBSTATUS_FLINCHED, [hl]","\tjr z, .not_flinched","","\tres SUBSTATUS_FLINCHED, [hl]","\tld hl, FlinchedText","\tcall StdBattleTextbox","","\tcall CantMove","\tjp EndTurn","",".not_flinched","","\tld hl, wPlayerDisableCount","\tld a, [hl]","\tand a","\tjr z, .not_disabled","","\tdec a","\tld [hl], a","\tand $f","\tjr nz, .not_disabled","","\tld [hl], a","\tld [wDisabledMove], a","\tld hl, DisabledNoMoreText","\tcall StdBattleTextbox","",".not_disabled","","\tld a, [wPlayerSubStatus3]","\tadd a","\tjr nc, .not_confused","\tld hl, wPlayerConfuseCount","\tdec [hl]","\tjr nz, .confused","","\tld hl, wPlayerSubStatus3","\tres SUBSTATUS_CONFUSED, [hl]","\tld hl, ConfusedNoMoreText","\tcall StdBattleTextbox","\tjr .not_confused","",".confused","\tld hl, IsConfusedText","\tcall StdBattleTextbox","\txor a","\tld [wNumHits], a","\tld de, ANIM_CONFUSED","\tcall FarPlayBattleAnimation","","\t; 50% chance of hitting itself","\tcall BattleRandom","\tcp 50 percent + 1","\tjr nc, .not_confused","","\t; clear confusion-dependent substatus","\tld hl, wPlayerSubStatus3","\tld a, [hl]","\tand 1 \u003c\u003c SUBSTATUS_CONFUSED","\tld [hl], a","","\tcall HitConfusion","\tcall CantMove","\tjp EndTurn","",".not_confused","","\tld a, [wPlayerSubStatus1]","\tadd a ; bit SUBSTATUS_ATTRACT","\tjr nc, .not_infatuated","","\tld hl, InLoveWithText","\tcall StdBattleTextbox","\txor a","\tld [wNumHits], a","\tld de, ANIM_IN_LOVE","\tcall FarPlayBattleAnimation","","\t; 50% chance of infatuation","\tcall BattleRandom","\tcp 50 percent + 1","\tjr c, .not_infatuated","","\tld hl, InfatuationText","\tcall StdBattleTextbox","\tcall CantMove","\tjp EndTurn","",".not_infatuated","","\t; We can\u0027t disable a move that doesn\u0027t exist.","\tld a, [wDisabledMove]","\tand a","\tjr z, .no_disabled_move","","\t; Are we using the disabled move?","\tld hl, wCurPlayerMove","\tcp [hl]","\tjr nz, .no_disabled_move","","\tcall MoveDisabled","\tcall CantMove","\tjp EndTurn","",".no_disabled_move","","\tld hl, wBattleMonStatus","\tbit PAR, [hl]","\tret z","","\t; 25% chance to be fully paralyzed","\tcall BattleRandom","\tcp 25 percent","\tret nc","","\tld hl, FullyParalyzedText","\tcall StdBattleTextbox","\tcall CantMove","\tjp EndTurn"],"name":"CheckPlayerTurn","file":"engine/battle/effect_commands.asm","lineNo":137,"address":116488,"addressUsedBy":[]}