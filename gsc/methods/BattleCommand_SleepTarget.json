{"names":["BattleCommand_SleepTarget"],"callingMethods":[],"methodsCalled":["AnimateCurrentMove","AnimateFailedMove","BattleRandom","CheckSubstituteOpp","FarCall","GetBattleVarAddr","GetItemName","GetOpponentItem","OpponentCantMove","PrintDidntAffect2","RefreshBattleHuds","StdBattleTextbox","UpdateOpponentInParty"],"methodAddressesUsed":["UseHeldStatusHealingItem"],"varsSet":["wNamedObjectIndexBuffer"],"varsUsed":["hBattleTurn","wAttackMissed","wInBattleTowerBattle","wLinkMode","wPlayerSubStatus5"],"varAddressesUsed":["ProtectedByText"],"constantsUsed":["BATTLE_VARS_STATUS_OPP"],"lines":["BattleCommand_SleepTarget:","; sleeptarget","","\tcall GetOpponentItem","\tld a, b","\tcp HELD_PREVENT_SLEEP","\tjr nz, .not_protected_by_item","","\tld a, [hl]","\tld [wNamedObjectIndexBuffer], a","\tcall GetItemName","\tld hl, ProtectedByText","\tjr .fail","",".not_protected_by_item","\tld a, BATTLE_VARS_STATUS_OPP","\tcall GetBattleVarAddr","\tld d, h","\tld e, l","\tld a, [de]","\tand SLP","\tld hl, AlreadyAsleepText","\tjr nz, .fail","","\tld a, [wAttackMissed]","\tand a","\tjp nz, PrintDidntAffect2","","\tld hl, DidntAffect1Text","\tcall .CheckAIRandomFail","\tjr c, .fail","","\tld a, [de]","\tand a","\tjr nz, .fail","","\tcall CheckSubstituteOpp","\tjr nz, .fail","","\tcall AnimateCurrentMove","\tld b, $7","\tld a, [wInBattleTowerBattle]","\tand a","\tjr z, .random_loop","\tld b, $3","",".random_loop","\tcall BattleRandom","\tand b","\tjr z, .random_loop","\tcp 7","\tjr z, .random_loop","\tinc a","\tld [de], a","\tcall UpdateOpponentInParty","\tcall RefreshBattleHuds","","\tld hl, FellAsleepText","\tcall StdBattleTextbox","","\tfarcall UseHeldStatusHealingItem","","\tjp z, OpponentCantMove","\tret","",".fail","\tpush hl","\tcall AnimateFailedMove","\tpop hl","\tjp StdBattleTextbox","",".CheckAIRandomFail:","\t; Enemy turn","\tldh a, [hBattleTurn]","\tand a","\tjr z, .dont_fail","","\t; Not in link battle","\tld a, [wLinkMode]","\tand a","\tjr nz, .dont_fail","","\tld a, [wInBattleTowerBattle]","\tand a","\tjr nz, .dont_fail","","\t; Not locked-on by the enemy","\tld a, [wPlayerSubStatus5]","\tbit SUBSTATUS_LOCK_ON, a","\tjr nz, .dont_fail","","\tcall BattleRandom","\tcp 25 percent + 1 ; 25% chance AI fails","\tret c","",".dont_fail","\txor a","\tret"],"name":"BattleCommand_SleepTarget","file":"engine/battle/effect_commands.asm","lineNo":3596,"address":120341,"addressUsedBy":[]}