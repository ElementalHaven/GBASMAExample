{"names":["MysteryGift_ReadJoypad"],"callingMethods":["Function104a95","Function104ddd"],"methodsCalled":[],"methodAddressesUsed":[],"varsSet":["hMGJoypadPressed","hMGJoypadReleased","rJOYP"],"varsUsed":["hMGJoypadPressed","rJOYP"],"varAddressesUsed":[],"constantsUsed":["R_BUTTONS","R_DPAD"],"lines":["MysteryGift_ReadJoypad:","; We can only get four inputs at a time.","; We take d-pad first for no particular reason.","\tld a, R_DPAD","\tldh [rJOYP], a","; Read twice to give the request time to take.","\tldh a, [rJOYP]","\tldh a, [rJOYP]","","; The Joypad register output is in the lo nybble (inversed).","; We make the hi nybble of our new container d-pad input.","\tcpl","\tand $f","\tswap a","","; We\u0027ll keep this in b for now.","\tld b, a","","; Buttons make 8 total inputs (A, B, Select, Start).","; We can fit this into one byte.","\tld a, R_BUTTONS","\tldh [rJOYP], a","; Wait for input to stabilize.","rept 6","\tldh a, [rJOYP]","endr","; Buttons take the lo nybble.","\tcpl","\tand $f","\tor b","\tld c, a","; To get the delta we xor the last frame\u0027s input with the new one.","\tldh a, [hMGJoypadPressed]","\txor c","; Released this frame:","\tand c","\tldh [hMGJoypadReleased], a","; Pressed this frame:","\tld a, c","\tldh [hMGJoypadPressed], a","\tld a, $30","; Reset the joypad register since we\u0027re done with it.","\tldh [rJOYP], a","\tret"],"name":"MysteryGift_ReadJoypad","file":"engine/link/mystery_gift.asm","lineNo":1060,"address":263800,"addressUsedBy":[]}