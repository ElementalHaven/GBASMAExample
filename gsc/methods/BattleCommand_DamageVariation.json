{"names":["BattleCommand_DamageVariation"],"callingMethods":[],"methodsCalled":["BattleRandom","Divide","Multiply"],"methodAddressesUsed":[],"varsSet":["hDivisor","hMultiplicand","hMultiplier"],"varsUsed":["hQuotient"],"varAddressesUsed":["wCurDamage"],"constantsUsed":["percent"],"lines":["BattleCommand_DamageVariation:","; damagevariation","","; Modify the damage spread between 85% and 100%.","","; Because of the method of division the probability distribution","; is not consistent. This makes the highest damage multipliers","; rarer than normal.","","; No point in reducing 1 or 0 damage.","\tld hl, wCurDamage","\tld a, [hli]","\tand a","\tjr nz, .go","\tld a, [hl]","\tcp 2","\tret c","",".go","; Start with the maximum damage.","\txor a","\tldh [hMultiplicand + 0], a","\tdec hl","\tld a, [hli]","\tldh [hMultiplicand + 1], a","\tld a, [hl]","\tldh [hMultiplicand + 2], a","","; Multiply by 85-100%...",".loop","\tcall BattleRandom","\trrca","\tcp 85 percent + 1","\tjr c, .loop","","\tldh [hMultiplier], a","\tcall Multiply","","; ...divide by 100%...","\tld a, 100 percent","\tldh [hDivisor], a","\tld b, $4","\tcall Divide","","; ...to get .85-1.00x damage.","\tldh a, [hQuotient + 2]","\tld hl, wCurDamage","\tld [hli], a","\tldh a, [hQuotient + 3]","\tld [hl], a","\tret"],"name":"BattleCommand_DamageVariation","file":"engine/battle/effect_commands.asm","lineNo":1507,"address":118042,"addressUsedBy":[]}