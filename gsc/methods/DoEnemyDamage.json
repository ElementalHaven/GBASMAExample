{"names":["DoEnemyDamage"],"callingMethods":["BattleCommand_ApplyDamage","CheckEnemyTurn","GetFailureResultText"],"methodsCalled":["DoSubstituteDamage","Predef","RefreshBattleHuds"],"methodAddressesUsed":[],"varsSet":["wBuffer1","wBuffer2","wBuffer3","wBuffer4","wBuffer5","wBuffer6","wEnemyMonHP","wWhichHPBar"],"varsUsed":["wBuffer3","wBuffer4","wEnemyMonHP","wEnemySubStatus4"],"varAddressesUsed":["AnimateHPBarPredef","wCurDamage","wEnemyMonHP","wEnemyMonMaxHP"],"constantsUsed":[],"lines":["DoEnemyDamage:","\tld hl, wCurDamage","\tld a, [hli]","\tld b, a","\tld a, [hl]","\tor b","\tjr z, .did_no_damage","","\tld a, c","\tand a","\tjr nz, .ignore_substitute","\tld a, [wEnemySubStatus4]","\tbit SUBSTATUS_SUBSTITUTE, a","\tjp nz, DoSubstituteDamage","",".ignore_substitute","\t; Substract wCurDamage from wEnemyMonHP.","\t;  store original HP in little endian wBuffer3/4","\tld a, [hld]","\tld b, a","\tld a, [wEnemyMonHP + 1]","\tld [wBuffer3], a","\tsub b","\tld [wEnemyMonHP + 1], a","\tld a, [hl]","\tld b, a","\tld a, [wEnemyMonHP]","\tld [wBuffer4], a","\tsbc b","\tld [wEnemyMonHP], a","\tjr nc, .no_underflow","","\tld a, [wBuffer4]","\tld [hli], a","\tld a, [wBuffer3]","\tld [hl], a","\txor a","\tld hl, wEnemyMonHP","\tld [hli], a","\tld [hl], a","",".no_underflow","\tld hl, wEnemyMonMaxHP","\tld a, [hli]","\tld [wBuffer2], a","\tld a, [hl]","\tld [wBuffer1], a","\tld hl, wEnemyMonHP","\tld a, [hli]","\tld [wBuffer6], a","\tld a, [hl]","\tld [wBuffer5], a","","\thlcoord 2, 2","\txor a","\tld [wWhichHPBar], a","\tpredef AnimateHPBar",".did_no_damage","\tjp RefreshBattleHuds"],"name":"DoEnemyDamage","file":"engine/battle/effect_commands.asm","lineNo":3403,"address":120190,"addressUsedBy":[]}