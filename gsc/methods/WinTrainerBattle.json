{"names":["WinTrainerBattle"],"callingMethods":["HandleEnemyMonFaint","HandlePlayerMonFaint"],"methodsCalled":["AddBattleMoneyToAccount","BattleWinSlideInEnemyTrainerFrontpic","ClearBGPalettes","ClearTilemap","DelayFrames","EmptyBattleTextbox","FarCall","IsMobileBattle","PlayVictoryMusic","Predef","PrintWinLossText","StdBattleTextbox","StopDangerSound","WaitPressAorB_BlinkCursor"],"methodAddressesUsed":["BattleTowerText","Battle_GetTrainerName","Mobile_PrintOpponentBattleMessage"],"varsSet":["wBattleEnded","wBattleLowHealthAlarm"],"varsUsed":["wAmuletCoin","wBattleType","wDebugFlags","wInBattleTowerBattle","wLinkMode","wMomSavingMoney"],"varAddressesUsed":["GotMoneyForWinningText","HealPartyPredef","wBattleReward","wMomsMoney","wMoney","wPayDayMoney"],"constantsUsed":["BATTLETOWERTEXT_LOSS_TEXT","FALSE"],"lines":["WinTrainerBattle:","; Player won the battle","\tcall StopDangerSound","\tld a, $1","\tld [wBattleLowHealthAlarm], a","\tld [wBattleEnded], a","\tld a, [wLinkMode]","\tand a","\tld a, b","\tcall z, PlayVictoryMusic","\tcallfar Battle_GetTrainerName","\tld hl, BattleText_EnemyWasDefeated","\tcall StdBattleTextbox","","\tcall IsMobileBattle","\tjr z, .mobile","\tld a, [wLinkMode]","\tand a","\tret nz","","\tld a, [wInBattleTowerBattle]","\tbit 0, a","\tjr nz, .battle_tower","","\tcall BattleWinSlideInEnemyTrainerFrontpic","\tld c, 40","\tcall DelayFrames","\tld a, [wBattleType]","\tcp BATTLETYPE_CANLOSE","\tjr nz, .skip_heal","\tpredef HealParty",".skip_heal","\tld a, [wDebugFlags]","\tbit DEBUG_BATTLE_F, a","\tjr nz, .skip_win_loss_text","\tcall PrintWinLossText","",".skip_win_loss_text","\tjp .GiveMoney","",".mobile","\tcall BattleWinSlideInEnemyTrainerFrontpic","\tld c, 40","\tcall DelayFrames","\tld c, $4 ; win","\tfarcall Mobile_PrintOpponentBattleMessage","\tret","",".battle_tower","\tcall BattleWinSlideInEnemyTrainerFrontpic","\tld c, 40","\tcall DelayFrames","\tcall EmptyBattleTextbox","\tld c, BATTLETOWERTEXT_LOSS_TEXT","\tfarcall BattleTowerText","\tcall WaitPressAorB_BlinkCursor","\tld hl, wPayDayMoney","\tld a, [hli]","\tor [hl]","\tinc hl","\tor [hl]","\tret nz","\tcall ClearTilemap","\tcall ClearBGPalettes","\tret","",".GiveMoney:","\tld a, [wAmuletCoin]","\tand a","\tcall nz, .DoubleReward","\tcall .CheckMaxedOutMomMoney","\tpush af","\tld a, FALSE","\tjr nc, .okay","\tld a, [wMomSavingMoney]","\tand MOM_SAVING_MONEY_MASK","\tcp (1 \u003c\u003c MOM_SAVING_SOME_MONEY_F) | (1 \u003c\u003c MOM_SAVING_HALF_MONEY_F)","\tjr nz, .okay","\tinc a ; TRUE","",".okay","\tld b, a","\tld c, 4",".loop","\tld a, b","\tand a","\tjr z, .loop2","\tcall .AddMoneyToMom","\tdec c","\tdec b","\tjr .loop","",".loop2","\tld a, c","\tand a","\tjr z, .done","\tcall .AddMoneyToWallet","\tdec c","\tjr .loop2","",".done","\tcall .DoubleReward","\tcall .DoubleReward","\tpop af","\tjr nc, .KeepItAll","\tld a, [wMomSavingMoney]","\tand MOM_SAVING_MONEY_MASK","\tjr z, .KeepItAll","\tld hl, .SentToMomTexts","\tdec a","\tld c, a","\tld b, 0","\tadd hl, bc","\tadd hl, bc","\tld a, [hli]","\tld h, [hl]","\tld l, a","\tjp StdBattleTextbox","",".KeepItAll:","\tld hl, GotMoneyForWinningText","\tjp StdBattleTextbox","",".AddMoneyToMom:","\tpush bc","\tld hl, wBattleReward + 2","\tld de, wMomsMoney + 2","\tcall AddBattleMoneyToAccount","\tpop bc","\tret","",".AddMoneyToWallet:","\tpush bc","\tld hl, wBattleReward + 2","\tld de, wMoney + 2","\tcall AddBattleMoneyToAccount","\tpop bc","\tret","",".DoubleReward:","\tld hl, wBattleReward + 2","\tsla [hl]","\tdec hl","\trl [hl]","\tdec hl","\trl [hl]","\tret nc","\tld a, $ff","\tld [hli], a","\tld [hli], a","\tld [hl], a","\tret","",".SentToMomTexts:","; entries correspond to MOM_SAVING_* constants","\tdw SentSomeToMomText","\tdw SentHalfToMomText","\tdw SentAllToMomText","",".CheckMaxedOutMomMoney:","\tld hl, wMomsMoney + 2","\tld a, [hld]","\tcp LOW(MAX_MONEY)","\tld a, [hld]","\tsbc HIGH(MAX_MONEY) ; mid","\tld a, [hl]","\tsbc HIGH(MAX_MONEY \u003e\u003e 8)","\tret"],"name":"WinTrainerBattle","file":"engine/battle/core.asm","lineNo":2342,"address":135964,"addressUsedBy":[]}