{"names":["_CardFlip"],"callingMethods":[],"methodsCalled":["AddNTimes","CardFlip_BlankDiscardedCardSlot","CardFlip_CheckWinCondition","CardFlip_DisplayCardFaceUp","CardFlip_FillGreenBox","CardFlip_InitAttrPals","CardFlip_InitTilemap","CardFlip_PrintCoinBalance","CardFlip_ShiftDigitsUpOnePixel","CardFlip_ShuffleDeck","CardFlip_UpdateCoinBalanceDisplay","CardFlip_UpdateCursorOAM","ChooseCard_HandleJoypad","ClearBGPalettes","ClearSprites","ClearTilemap","CopyBytes","Decompress","DelayFrame","DelayFrames","DisableLCD","DmgToCgbBGPals","DmgToCgbObjPals","EnableLCD","GetCoordsOfChosenCard","JoyTextDelay","LoadFontsExtra","LoadStandardFont","PlaceCardFaceDown","PlaceOAMCardBorder","PlayMusic","PlaySFX","PrintText","WaitBGMap","WaitBGMap2","WaitPressAorB_BlinkCursor","WaitSFX","YesNoBox"],"methodAddressesUsed":[],"varsSet":["hBGMapMode","hVBlankCounter","wCardFlipCursorX","wCardFlipCursorY","wCardFlipFaceUpCard","wCardFlipNumCardsPlayed","wCardFlipWhichCard","wCoins","wJumptableIndex"],"varsUsed":["hJoyLast","wCardFlipNumCardsPlayed","wCardFlipWhichCard","wCoins","wJumptableIndex"],"varAddressesUsed":["vTiles0","vTiles2","wCardFlipWhichCard","wDeck","wDiscardPile","wOptions"],"constantsUsed":["CARDFLIP_LIGHT_OFF","CARDFLIP_LIGHT_ON","MUSIC_GAME_CORNER","MUSIC_NONE","SCREEN_WIDTH","SFX_CHOOSE_A_CARD","SFX_KINESIS","SFX_QUIT_SLOTS","SFX_SLOT_MACHINE_START","SFX_TRANSACTION","TRUE","tile","tiles"],"lines":["_CardFlip:","\tld hl, wOptions","\tset NO_TEXT_SCROLL, [hl]","\tcall ClearBGPalettes","\tcall ClearTilemap","\tcall ClearSprites","\tld de, MUSIC_NONE","\tcall PlayMusic","\tcall DelayFrame","\tcall DisableLCD","\tcall LoadStandardFont","\tcall LoadFontsExtra","","\tld hl, CardFlipLZ01","\tld de, vTiles2 tile $00","\tcall Decompress","\tld hl, CardFlipLZ02","\tld de, vTiles2 tile $3e","\tcall Decompress","\tld hl, CardFlipLZ03","\tld de, vTiles0 tile $00","\tcall Decompress","\tld hl, CardFlipOffButtonGFX","\tld de, vTiles0 tile CARDFLIP_LIGHT_OFF","\tld bc, 1 tiles","\tcall CopyBytes","\tld hl, CardFlipOnButtonGFX","\tld de, vTiles0 tile CARDFLIP_LIGHT_ON","\tld bc, 1 tiles","\tcall CopyBytes","","\tcall CardFlip_ShiftDigitsUpOnePixel","\tcall CardFlip_InitTilemap","\tcall CardFlip_InitAttrPals","\tcall EnableLCD","\tcall WaitBGMap2","\tld a, %11100100","\tcall DmgToCgbBGPals","\tlb de, %11100100, %11100100","\tcall DmgToCgbObjPals","\tcall DelayFrame","\txor a","\tld [wJumptableIndex], a","\tld a, $2","\tld [wCardFlipCursorY], a","\tld [wCardFlipCursorX], a","\tld de, MUSIC_GAME_CORNER","\tcall PlayMusic",".MasterLoop:","\tld a, [wJumptableIndex]","\tbit 7, a","\tjr nz, .leavethegame","\tcall .CardFlip","\tjr .MasterLoop",".leavethegame","\tcall WaitSFX","\tld de, SFX_QUIT_SLOTS","\tcall PlaySFX","\tcall WaitSFX","\tcall ClearBGPalettes","\tld hl, wOptions","\tres 4, [hl]","\tret","",".CardFlip:","\tld a, [wJumptableIndex]","\tld e, a","\tld d, 0","\tld hl, .Jumptable","\tadd hl, de","\tadd hl, de","\tld a, [hli]","\tld h, [hl]","\tld l, a","\tjp hl","",".Jumptable:","\tdw .AskPlayWithThree","\tdw .DeductCoins","\tdw .ChooseACard","\tdw .PlaceYourBet","\tdw .CheckTheCard","\tdw .TabulateTheResult","\tdw .PlayAgain","\tdw .Quit","",".Increment:","\tld hl, wJumptableIndex","\tinc [hl]","\tret","",".AskPlayWithThree:","\tld hl, .CardFlipPlayWithThreeCoinsText","\tcall CardFlip_UpdateCoinBalanceDisplay","\tcall YesNoBox","\tjr c, .SaidNo","\tcall CardFlip_ShuffleDeck","\tcall .Increment","\tret","",".SaidNo:","\tld a, 7","\tld [wJumptableIndex], a","\tret","",".CardFlipPlayWithThreeCoinsText:","\ttext_far _CardFlipPlayWithThreeCoinsText","\ttext_end","",".DeductCoins:","\tld a, [wCoins]","\tld h, a","\tld a, [wCoins + 1]","\tld l, a","\tld a, h","\tand a","\tjr nz, .deduct ; You have at least 256 coins.","\tld a, l","\tcp 3","\tjr nc, .deduct ; You have at least 3 coins.","\tld hl, .CardFlipNotEnoughCoinsText","\tcall CardFlip_UpdateCoinBalanceDisplay","\tld a, 7","\tld [wJumptableIndex], a","\tret","",".deduct","\tld de, -3","\tadd hl, de","\tld a, h","\tld [wCoins], a","\tld a, l","\tld [wCoins + 1], a","\tld de, SFX_TRANSACTION","\tcall PlaySFX","\txor a","\tldh [hBGMapMode], a","\tcall CardFlip_PrintCoinBalance","\tld a, $1","\tldh [hBGMapMode], a","\tcall WaitSFX","\tcall .Increment","\tret","",".CardFlipNotEnoughCoinsText:","\ttext_far _CardFlipNotEnoughCoinsText","\ttext_end","",".ChooseACard:","\txor a","\tldh [hBGMapMode], a","\thlcoord 0, 0","\tlb bc, 12, 9","\tcall CardFlip_FillGreenBox","\thlcoord 9, 0","\tld bc, SCREEN_WIDTH","\tld a, [wCardFlipNumCardsPlayed]","\tcall AddNTimes","\tld [hl], CARDFLIP_LIGHT_ON","\tld a, $1","\tldh [hBGMapMode], a","\tld c, 20","\tcall DelayFrames","\thlcoord 2, 0","\tcall PlaceCardFaceDown","\tld a, $1","\tldh [hBGMapMode], a","\tld c, 20","\tcall DelayFrames","\thlcoord 2, 6","\tcall PlaceCardFaceDown","\tcall WaitBGMap","\tld hl, .CardFlipChooseACardText","\tcall CardFlip_UpdateCoinBalanceDisplay","\txor a","\tld [wCardFlipWhichCard], a",".loop","\tcall JoyTextDelay","\tldh a, [hJoyLast]","\tand A_BUTTON","\tjr nz, .next","\tld de, SFX_KINESIS","\tcall PlaySFX","\tcall PlaceOAMCardBorder","\tld c, 4","\tcall DelayFrames","\tld hl, wCardFlipWhichCard","\tld a, [hl]","\txor $1","\tld [hl], a","\tjr .loop","",".next","\tld de, SFX_SLOT_MACHINE_START","\tcall PlaySFX","\tld a, $3",".loop2","\tpush af","\tcall PlaceOAMCardBorder","\tld c, 4","\tcall DelayFrames","\tcall ClearSprites","\tld c, 4","\tcall DelayFrames","\tpop af","\tdec a","\tjr nz, .loop2","\tld hl, wCardFlipWhichCard","\tld a, [hl]","\tpush af","\txor $1","\tld [hl], a","\tcall GetCoordsOfChosenCard","\tlb bc, 6, 5","\tcall CardFlip_FillGreenBox","\tpop af","\tld [wCardFlipWhichCard], a","\tcall .Increment","\tret","",".CardFlipChooseACardText:","\ttext_far _CardFlipChooseACardText","\ttext_end","",".PlaceYourBet:","\tld hl, .CardFlipPlaceYourBetText","\tcall CardFlip_UpdateCoinBalanceDisplay",".betloop","\tcall JoyTextDelay","\tldh a, [hJoyLast]","\tand A_BUTTON","\tjr nz, .betdone","\tcall ChooseCard_HandleJoypad","\tcall CardFlip_UpdateCursorOAM","\tcall DelayFrame","\tjr .betloop","",".betdone","\tcall .Increment","\tret","",".CardFlipPlaceYourBetText:","\ttext_far _CardFlipPlaceYourBetText","\ttext_end","",".CheckTheCard:","\txor a","\tldh [hVBlankCounter], a","\tcall CardFlip_UpdateCursorOAM","\tcall WaitSFX","\tld de, SFX_CHOOSE_A_CARD","\tcall PlaySFX","\tcall WaitSFX","\tld a, [wCardFlipNumCardsPlayed]","\tld e, a","\tld d, 0","\tld hl, wDeck","\tadd hl, de","\tadd hl, de","\tld a, [wCardFlipWhichCard]","\tld e, a","\tadd hl, de","\tld a, [hl]","\tld [wCardFlipFaceUpCard], a","\tld e, a","\tld hl, wDiscardPile","\tadd hl, de","\tld [hl], TRUE","\tcall GetCoordsOfChosenCard","\tcall CardFlip_DisplayCardFaceUp","\tcall WaitBGMap2","\tcall .Increment","\tret","",".TabulateTheResult:","\tcall CardFlip_CheckWinCondition","\tcall WaitPressAorB_BlinkCursor","\tcall .Increment","\tret","",".PlayAgain:","\tcall ClearSprites","\tld hl, .CardFlipPlayAgainText","\tcall CardFlip_UpdateCoinBalanceDisplay","\tcall YesNoBox","\tjr nc, .Continue","\tcall .Increment","\tret","",".Continue:","\tld a, [wCardFlipNumCardsPlayed]","\tinc a","\tld [wCardFlipNumCardsPlayed], a","\tcp 12","\tjr c, .KeepTheCurrentDeck","\tcall CardFlip_InitTilemap","\tld a, $1","\tldh [hBGMapMode], a","\tcall CardFlip_ShuffleDeck","\tld hl, .CardFlipShuffledText","\tcall PrintText","\tjr .LoopAround","",".KeepTheCurrentDeck:","\tcall CardFlip_BlankDiscardedCardSlot","",".LoopAround:","\tld a, 1","\tld [wJumptableIndex], a","\tret","",".CardFlipPlayAgainText:","\ttext_far _CardFlipPlayAgainText","\ttext_end","",".CardFlipShuffledText:","\ttext_far _CardFlipShuffledText","\ttext_end","",".Quit:","\tld hl, wJumptableIndex","\tset 7, [hl]","\tret"],"name":"_CardFlip","file":"engine/games/card_flip.asm","lineNo":13,"address":242984,"addressUsedBy":["CardFlip"]}