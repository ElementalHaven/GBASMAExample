{"names":["BattleCommand_EndLoop"],"callingMethods":[],"methodsCalled":["BattleCommand_BeatUpFailText","BattleRandom","EndMoveEffect","GetBattleVar","GetBattleVarAddr","StdBattleTextbox"],"methodAddressesUsed":[],"varsSet":["wBattleScriptBufferAddress"],"varsUsed":["hBattleTurn","wBattleMode","wBattleScriptBufferAddress","wOTPartyCount","wPartyCount"],"varAddressesUsed":["EnemyHitTimesText","PlayerHitTimesText","wEnemyDamageTaken","wEnemyRolloutCount","wPlayerDamageTaken","wPlayerRolloutCount"],"constantsUsed":["BATTLE_VARS_MOVE_EFFECT","BATTLE_VARS_SUBSTATUS3"],"lines":["BattleCommand_EndLoop:","; endloop","","; Loop back to \u0027critical\u0027.","","\tld de, wPlayerRolloutCount","\tld bc, wPlayerDamageTaken","\tldh a, [hBattleTurn]","\tand a","\tjr z, .got_addrs","\tld de, wEnemyRolloutCount","\tld bc, wEnemyDamageTaken",".got_addrs","","\tld a, BATTLE_VARS_SUBSTATUS3","\tcall GetBattleVarAddr","\tbit SUBSTATUS_IN_LOOP, [hl]","\tjp nz, .in_loop","\tset SUBSTATUS_IN_LOOP, [hl]","\tld a, BATTLE_VARS_MOVE_EFFECT","\tcall GetBattleVarAddr","\tld a, [hl]","\tcp EFFECT_POISON_MULTI_HIT","\tjr z, .twineedle","\tcp EFFECT_DOUBLE_HIT","\tld a, 1","\tjr z, .double_hit","\tld a, [hl]","\tcp EFFECT_BEAT_UP","\tjr z, .beat_up","\tcp EFFECT_TRIPLE_KICK","\tjr nz, .not_triple_kick",".reject_triple_kick_sample","\tcall BattleRandom","\tand $3","\tjr z, .reject_triple_kick_sample","\tdec a","\tjr nz, .double_hit","\tld a, 1","\tld [bc], a","\tjr .done_loop","",".beat_up","\tldh a, [hBattleTurn]","\tand a","\tjr nz, .check_ot_beat_up","\tld a, [wPartyCount]","\tcp 1","\tjp z, .only_one_beatup","\tdec a","\tjr .double_hit","",".check_ot_beat_up","\tld a, [wBattleMode]","\tcp WILD_BATTLE","\tjp z, .only_one_beatup","\tld a, [wOTPartyCount]","\tcp 1","\tjp z, .only_one_beatup","\tdec a","\tjr .double_hit","",".only_one_beatup","\tld a, BATTLE_VARS_SUBSTATUS3","\tcall GetBattleVarAddr","\tres SUBSTATUS_IN_LOOP, [hl]","\tcall BattleCommand_BeatUpFailText","\tjp EndMoveEffect","",".not_triple_kick","\tcall BattleRandom","\tand $3","\tcp 2","\tjr c, .got_number_hits","\tcall BattleRandom","\tand $3",".got_number_hits","\tinc a",".double_hit","\tld [de], a","\tinc a","\tld [bc], a","\tjr .loop_back_to_critical","",".twineedle","\tld a, 1","\tjr .double_hit","",".in_loop","\tld a, [de]","\tdec a","\tld [de], a","\tjr nz, .loop_back_to_critical",".done_loop","\tld a, BATTLE_VARS_SUBSTATUS3","\tcall GetBattleVarAddr","\tres SUBSTATUS_IN_LOOP, [hl]","","\tld hl, PlayerHitTimesText","\tldh a, [hBattleTurn]","\tand a","\tjr z, .got_hit_n_times_text","\tld hl, EnemyHitTimesText",".got_hit_n_times_text","","\tpush bc","\tld a, BATTLE_VARS_MOVE_EFFECT","\tcall GetBattleVar","\tcp EFFECT_BEAT_UP","\tjr z, .beat_up_2","\tcall StdBattleTextbox",".beat_up_2","","\tpop bc","\txor a","\tld [bc], a","\tret","",".loop_back_to_critical","\tld a, [wBattleScriptBufferAddress + 1]","\tld h, a","\tld a, [wBattleScriptBufferAddress]","\tld l, a",".not_critical","\tld a, [hld]","\tcp critical_command","\tjr nz, .not_critical","\tinc hl","\tld a, h","\tld [wBattleScriptBufferAddress + 1], a","\tld a, l","\tld [wBattleScriptBufferAddress], a","\tret"],"name":"BattleCommand_EndLoop","file":"engine/battle/effect_commands.asm","lineNo":5286,"address":121811,"addressUsedBy":[]}