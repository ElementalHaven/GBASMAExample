{"names":["MoveSelectionScreen"],"callingMethods":["MoveSelectionScreen","ParsePlayerAction"],"methodsCalled":["AddNTimes","CheckPlayerHasUsableMoves","CopyBytes","FarCall","GetPartyLocation","GetPartyParamLocation","IsMobileBattle","MoveInfoBox","MoveSelectionScreen","PlaceString","Predef","SafeLoadTempTilemapToTilemap","ScrollingMenuJoypad","StdBattleTextbox","Textbox"],"methodAddressesUsed":["MobileMoveSelectionScreen"],"varsSet":["hBGMapMode","w2DMenuCursorInitX","w2DMenuCursorInitY","w2DMenuCursorOffsets","w2DMenuFlags1","w2DMenuFlags2","w2DMenuNumCols","w2DMenuNumRows","wBuffer1","wCurMoveNum","wCurPlayerMove","wMenuCursorX","wMenuCursorY","wMenuJoypadFilter","wMoveSwapBuffer"],"varsUsed":["wCurBattleMon","wCurMoveNum","wLinkMode","wMenuCursorY","wMoveSelectionMenuType","wMoveSwapBuffer","wNumMoves","wPlayerDisableCount","wPlayerSubStatus5","wUnusedPlayerLockedMove"],"varAddressesUsed":["ListMovesPredef","wBattleMonMoves","wBattleMonPP","wEnemyMonMoves","wListMoves_MoveIndicesBuffer","wPartyMon1Moves","wPlayerDisableCount"],"constantsUsed":["A_BUTTON","B_BUTTON","D_DOWN","D_UP","MON_MOVES","MON_PP","NUM_MOVES","SCREEN_WIDTH","SELECT","STATICMENU_ENABLE_LEFT_RIGHT","STATICMENU_ENABLE_START","STATICMENU_WRAP"],"lines":["MoveSelectionScreen:","\tcall IsMobileBattle","\tjr nz, .not_mobile","\tfarcall MobileMoveSelectionScreen","\tret","",".not_mobile","\tld hl, wEnemyMonMoves","\tld a, [wMoveSelectionMenuType]","\tdec a","\tjr z, .got_menu_type","\tdec a","\tjr z, .ether_elixer_menu","\tcall CheckPlayerHasUsableMoves","\tret z ; use Struggle","\tld hl, wBattleMonMoves","\tjr .got_menu_type","",".ether_elixer_menu","\tld a, MON_MOVES","\tcall GetPartyParamLocation","",".got_menu_type","\tld de, wListMoves_MoveIndicesBuffer","\tld bc, NUM_MOVES","\tcall CopyBytes","\txor a","\tldh [hBGMapMode], a","","\thlcoord 4, 17 - NUM_MOVES - 1","\tld b, 4","\tld c, 14","\tld a, [wMoveSelectionMenuType]","\tcp $2","\tjr nz, .got_dims","\thlcoord 4, 17 - NUM_MOVES - 1 - 4","\tld b, 4","\tld c, 14",".got_dims","\tcall Textbox","","\thlcoord 6, 17 - NUM_MOVES","\tld a, [wMoveSelectionMenuType]","\tcp $2","\tjr nz, .got_start_coord","\thlcoord 6, 17 - NUM_MOVES - 4",".got_start_coord","\tld a, SCREEN_WIDTH","\tld [wBuffer1], a","\tpredef ListMoves","","\tld b, 5","\tld a, [wMoveSelectionMenuType]","\tcp $2","\tld a, 17 - NUM_MOVES","\tjr nz, .got_default_coord","\tld b, 5","\tld a, 17 - NUM_MOVES - 4","",".got_default_coord","\tld [w2DMenuCursorInitY], a","\tld a, b","\tld [w2DMenuCursorInitX], a","\tld a, [wMoveSelectionMenuType]","\tcp $1","\tjr z, .skip_inc","\tld a, [wCurMoveNum]","\tinc a","",".skip_inc","\tld [wMenuCursorY], a","\tld a, 1","\tld [wMenuCursorX], a","\tld a, [wNumMoves]","\tinc a","\tld [w2DMenuNumRows], a","\tld a, 1","\tld [w2DMenuNumCols], a","\tld c, STATICMENU_ENABLE_LEFT_RIGHT | STATICMENU_ENABLE_START | STATICMENU_WRAP","\tld a, [wMoveSelectionMenuType]","\tdec a","\tld b, D_DOWN | D_UP | A_BUTTON","\tjr z, .okay","\tdec a","\tld b, D_DOWN | D_UP | A_BUTTON | B_BUTTON","\tjr z, .okay","\tld a, [wLinkMode]","\tand a","\tjr nz, .okay","\tld b, D_DOWN | D_UP | A_BUTTON | B_BUTTON | SELECT","",".okay","\tld a, b","\tld [wMenuJoypadFilter], a","\tld a, c","\tld [w2DMenuFlags1], a","\txor a","\tld [w2DMenuFlags2], a","\tld a, $10","\tld [w2DMenuCursorOffsets], a",".menu_loop","\tld a, [wMoveSelectionMenuType]","\tand a","\tjr z, .battle_player_moves","\tdec a","\tjr nz, .interpret_joypad","\thlcoord 11, 14","\tld de, .empty_string","\tcall PlaceString","\tjr .interpret_joypad","",".battle_player_moves","\tcall MoveInfoBox","\tld a, [wMoveSwapBuffer]","\tand a","\tjr z, .interpret_joypad","\thlcoord 5, 13","\tld bc, SCREEN_WIDTH","\tdec a","\tcall AddNTimes","\tld [hl], \"â–·\"","",".interpret_joypad","\tld a, $1","\tldh [hBGMapMode], a","\tcall ScrollingMenuJoypad","\tbit D_UP_F, a","\tjp nz, .pressed_up","\tbit D_DOWN_F, a","\tjp nz, .pressed_down","\tbit SELECT_F, a","\tjp nz, .pressed_select","\tbit B_BUTTON_F, a","\t; A button","\tpush af","","\txor a","\tld [wMoveSwapBuffer], a","\tld a, [wMenuCursorY]","\tdec a","\tld [wMenuCursorY], a","\tld b, a","\tld a, [wMoveSelectionMenuType]","\tdec a","\tjr nz, .not_enemy_moves_process_b","","\tpop af","\tret","",".not_enemy_moves_process_b","\tdec a","\tld a, b","\tld [wCurMoveNum], a","\tjr nz, .use_move","","\tpop af","\tret","",".use_move","\tpop af","\tret nz","","\tld hl, wBattleMonPP","\tld a, [wMenuCursorY]","\tld c, a","\tld b, 0","\tadd hl, bc","\tld a, [hl]","\tand PP_MASK","\tjr z, .no_pp_left","\tld a, [wPlayerDisableCount]","\tswap a","\tand $f","\tdec a","\tcp c","\tjr z, .move_disabled","\tld a, [wUnusedPlayerLockedMove]","\tand a","\tjr nz, .skip2","\tld a, [wMenuCursorY]","\tld hl, wBattleMonMoves","\tld c, a","\tld b, 0","\tadd hl, bc","\tld a, [hl]","",".skip2","\tld [wCurPlayerMove], a","\txor a","\tret","",".move_disabled","\tld hl, BattleText_TheMoveIsDisabled","\tjr .place_textbox_start_over","",".no_pp_left","\tld hl, BattleText_TheresNoPPLeftForThisMove","",".place_textbox_start_over","\tcall StdBattleTextbox","\tcall SafeLoadTempTilemapToTilemap","\tjp MoveSelectionScreen","",".empty_string","\tdb \"@\"","",".pressed_up","\tld a, [wMenuCursorY]","\tand a","\tjp nz, .menu_loop","\tld a, [wNumMoves]","\tinc a","\tld [wMenuCursorY], a","\tjp .menu_loop","",".pressed_down","\tld a, [wMenuCursorY]","\tld b, a","\tld a, [wNumMoves]","\tinc a","\tinc a","\tcp b","\tjp nz, .menu_loop","\tld a, $1","\tld [wMenuCursorY], a","\tjp .menu_loop","",".pressed_select","\tld a, [wMoveSwapBuffer]","\tand a","\tjr z, .start_swap","\tld hl, wBattleMonMoves","\tcall .swap_bytes","\tld hl, wBattleMonPP","\tcall .swap_bytes","\tld hl, wPlayerDisableCount","\tld a, [hl]","\tswap a","\tand $f","\tld b, a","\tld a, [wMenuCursorY]","\tcp b","\tjr nz, .not_swapping_disabled_move","\tld a, [hl]","\tand $f","\tld b, a","\tld a, [wMoveSwapBuffer]","\tswap a","\tadd b","\tld [hl], a","\tjr .swap_moves_in_party_struct","",".not_swapping_disabled_move","\tld a, [wMoveSwapBuffer]","\tcp b","\tjr nz, .swap_moves_in_party_struct","\tld a, [hl]","\tand $f","\tld b, a","\tld a, [wMenuCursorY]","\tswap a","\tadd b","\tld [hl], a","",".swap_moves_in_party_struct","; Fixes the COOLTRAINER glitch","\tld a, [wPlayerSubStatus5]","\tbit SUBSTATUS_TRANSFORMED, a","\tjr nz, .transformed","\tld hl, wPartyMon1Moves","\tld a, [wCurBattleMon]","\tcall GetPartyLocation","\tpush hl","\tcall .swap_bytes","\tpop hl","\tld bc, MON_PP - MON_MOVES","\tadd hl, bc","\tcall .swap_bytes","",".transformed","\txor a","\tld [wMoveSwapBuffer], a","\tjp MoveSelectionScreen","",".swap_bytes","\tpush hl","\tld a, [wMoveSwapBuffer]","\tdec a","\tld c, a","\tld b, 0","\tadd hl, bc","\tld d, h","\tld e, l","\tpop hl","\tld a, [wMenuCursorY]","\tdec a","\tld c, a","\tld b, 0","\tadd hl, bc","\tld a, [de]","\tld b, [hl]","\tld [hl], a","\tld a, b","\tld [de], a","\tret","",".start_swap","\tld a, [wMenuCursorY]","\tld [wMoveSwapBuffer], a","\tjp MoveSelectionScreen"],"name":"MoveSelectionScreen","file":"engine/battle/core.asm","lineNo":5311,"address":138470,"addressUsedBy":["RestorePPEffect"]}