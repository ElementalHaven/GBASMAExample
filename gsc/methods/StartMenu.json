{"names":["StartMenu"],"callingMethods":[],"methodsCalled":["ByteFill","Call_ExitMenu","ClearBGPalettes","ClearBox","ClearWindowData","CloseText","DrawVariableLengthMenuBox","ExitMenu","FarCall","FinishExitMenu","GSReloadPalettes","GetScrollingMenuJoypad","LoadFontsExtra","LoadMenuHeader","PlaceHollowCursor","PlaceString","PlayClickSFX","PlaySFX","ReloadTilesetAndPalettes","SafeUpdateSprites","SetUpMenu","TextboxPalette","UpdateSprites","UpdateTimePals","_OpenAndCloseMenu_HDMATransferTilemapAndAttrmap"],"methodAddressesUsed":["LoadFonts_NoOAMUpdate","ReanchorBGMap_NoOAMUpdate","StartMenu_DrawBugContestStatusBox","StartMenu_PrintBugContestStatus"],"varsSet":["hBGMapMode","hMenuReturn","hOAMUpdate","wBattleMenuCursorBuffer","wMenuCursorBuffer","wMenuItemsList","wMenuSelection","wWhichIndexSet"],"varsUsed":["hOAMUpdate","wBattleMenuCursorBuffer","wLinkMode","wMenuCursorBuffer","wMenuJoypad","wMenuSelection","wOptions2","wPartyCount","wQueuedScriptBank"],"varAddressesUsed":["wMenuDataPointerTableAddr","wMenuItemsList","wPokegearFlags","wQueuedScriptAddr","wStatusFlags","wStatusFlags2"],"constantsUsed":["HMENURETURN_SCRIPT","SFX_MENU","STARTMENUITEM_EXIT","STARTMENUITEM_OPTION","STARTMENUITEM_PACK","STARTMENUITEM_POKEDEX","STARTMENUITEM_POKEGEAR","STARTMENUITEM_POKEMON","STARTMENUITEM_QUIT","STARTMENUITEM_SAVE","STARTMENUITEM_STATUS"],"lines":["StartMenu::","\tcall ClearWindowData","","\tld de, SFX_MENU","\tcall PlaySFX","","\tfarcall ReanchorBGMap_NoOAMUpdate","","\tld hl, wStatusFlags2","\tbit STATUSFLAGS2_BUG_CONTEST_TIMER_F, [hl]","\tld hl, .MenuHeader","\tjr z, .GotMenuData","\tld hl, .ContestMenuHeader","",".GotMenuData:","\tcall LoadMenuHeader","\tcall .SetUpMenuItems","\tld a, [wBattleMenuCursorBuffer]","\tld [wMenuCursorBuffer], a","\tcall .DrawMenuAccount","\tcall DrawVariableLengthMenuBox","\tcall .DrawBugContestStatusBox","\tcall SafeUpdateSprites","\tcall _OpenAndCloseMenu_HDMATransferTilemapAndAttrmap","\tfarcall LoadFonts_NoOAMUpdate","\tcall .DrawBugContestStatus","\tcall UpdateTimePals","\tjr .Select","",".Reopen:","\tcall UpdateSprites","\tcall UpdateTimePals","\tcall .SetUpMenuItems","\tld a, [wBattleMenuCursorBuffer]","\tld [wMenuCursorBuffer], a","",".Select:","\tcall .GetInput","\tjr c, .Exit","\tcall ._DrawMenuAccount","\tld a, [wMenuCursorBuffer]","\tld [wBattleMenuCursorBuffer], a","\tcall PlayClickSFX","\tcall PlaceHollowCursor","\tcall .OpenMenu","","; Menu items have different return functions.","; For example, saving exits the menu.","\tld hl, .MenuReturns","\tld e, a","\tld d, 0","\tadd hl, de","\tadd hl, de","\tld a, [hli]","\tld h, [hl]","\tld l, a","\tjp hl","",".MenuReturns:","\tdw .Reopen","\tdw .Exit","\tdw .ExitMenuCallFuncCloseText","\tdw .ExitMenuRunScriptCloseText","\tdw .ExitMenuRunScript","\tdw .ReturnEnd","\tdw .ReturnRedraw","",".Exit:","\tldh a, [hOAMUpdate]","\tpush af","\tld a, 1","\tldh [hOAMUpdate], a","\tcall LoadFontsExtra","\tpop af","\tldh [hOAMUpdate], a",".ReturnEnd:","\tcall ExitMenu",".ReturnEnd2:","\tcall CloseText","\tcall UpdateTimePals","\tret","",".GetInput:","; Return carry on exit, and no-carry on selection.","\txor a","\tldh [hBGMapMode], a","\tcall ._DrawMenuAccount","\tcall SetUpMenu","\tld a, $ff","\tld [wMenuSelection], a",".loop","\tcall .PrintMenuAccount","\tcall GetScrollingMenuJoypad","\tld a, [wMenuJoypad]","\tcp B_BUTTON","\tjr z, .b","\tcp A_BUTTON","\tjr z, .a","\tjr .loop",".a","\tcall PlayClickSFX","\tand a","\tret",".b","\tscf","\tret","",".ExitMenuRunScript:","\tcall ExitMenu","\tld a, HMENURETURN_SCRIPT","\tldh [hMenuReturn], a","\tret","",".ExitMenuRunScriptCloseText:","\tcall ExitMenu","\tld a, HMENURETURN_SCRIPT","\tldh [hMenuReturn], a","\tjr .ReturnEnd2","",".ExitMenuCallFuncCloseText:","\tcall ExitMenu","\tld hl, wQueuedScriptAddr","\tld a, [hli]","\tld h, [hl]","\tld l, a","\tld a, [wQueuedScriptBank]","\trst FarCall","\tjr .ReturnEnd2","",".ReturnRedraw:","\tcall .Clear","\tjp .Reopen","",".Clear:","\tcall ClearBGPalettes","\tcall Call_ExitMenu","\tcall ReloadTilesetAndPalettes","\tcall .DrawMenuAccount","\tcall DrawVariableLengthMenuBox","\tcall .DrawBugContestStatus","\tcall UpdateSprites","\tcall GSReloadPalettes","\tcall FinishExitMenu","\tret","",".MenuHeader:","\tdb MENU_BACKUP_TILES ; flags","\tmenu_coords 10, 0, SCREEN_WIDTH - 1, SCREEN_HEIGHT - 1","\tdw .MenuData","\tdb 1 ; default selection","",".ContestMenuHeader:","\tdb MENU_BACKUP_TILES ; flags","\tmenu_coords 10, 2, SCREEN_WIDTH - 1, SCREEN_HEIGHT - 1","\tdw .MenuData","\tdb 1 ; default selection","",".MenuData:","\tdb STATICMENU_CURSOR | STATICMENU_WRAP | STATICMENU_ENABLE_START ; flags","\tdn 0, 0 ; rows, columns","\tdw wMenuItemsList","\tdw .MenuString","\tdw .Items","",".Items:","; entries correspond to STARTMENUITEM_* constants","\tdw StartMenu_Pokedex,  .PokedexString,  .PokedexDesc","\tdw StartMenu_Pokemon,  .PartyString,    .PartyDesc","\tdw StartMenu_Pack,     .PackString,     .PackDesc","\tdw StartMenu_Status,   .StatusString,   .StatusDesc","\tdw StartMenu_Save,     .SaveString,     .SaveDesc","\tdw StartMenu_Option,   .OptionString,   .OptionDesc","\tdw StartMenu_Exit,     .ExitString,     .ExitDesc","\tdw StartMenu_Pokegear, .PokegearString, .PokegearDesc","\tdw StartMenu_Quit,     .QuitString,     .QuitDesc","",".PokedexString:  db \"#DEX@\"",".PartyString:    db \"#MON@\"",".PackString:     db \"PACK@\"",".StatusString:   db \"\u003cPLAYER\u003e@\"",".SaveString:     db \"SAVE@\"",".OptionString:   db \"OPTION@\"",".ExitString:     db \"EXIT@\"",".PokegearString: db \"\u003cPOKE\u003eGEAR@\"",".QuitString:     db \"QUIT@\"","",".PokedexDesc:","\tdb   \"#MON\"","\tnext \"database@\"","",".PartyDesc:","\tdb   \"Party \u003cPKMN\u003e\"","\tnext \"status@\"","",".PackDesc:","\tdb   \"Contains\"","\tnext \"items@\"","",".PokegearDesc:","\tdb   \"Trainer\u0027s\"","\tnext \"key device@\"","",".StatusDesc:","\tdb   \"Your own\"","\tnext \"status@\"","",".SaveDesc:","\tdb   \"Save your\"","\tnext \"progress@\"","",".OptionDesc:","\tdb   \"Change\"","\tnext \"settings@\"","",".ExitDesc:","\tdb   \"Close this\"","\tnext \"menu@\"","",".QuitDesc:","\tdb   \"Quit and\"","\tnext \"be judged.@\"","",".OpenMenu:","\tld a, [wMenuSelection]","\tcall .GetMenuAccountTextPointer","\tld a, [hli]","\tld h, [hl]","\tld l, a","\tjp hl","",".MenuString:","\tpush de","\tld a, [wMenuSelection]","\tcall .GetMenuAccountTextPointer","\tinc hl","\tinc hl","\tld a, [hli]","\tld d, [hl]","\tld e, a","\tpop hl","\tcall PlaceString","\tret","",".MenuDesc:","\tpush de","\tld a, [wMenuSelection]","\tcp $ff","\tjr z, .none","\tcall .GetMenuAccountTextPointer","rept 4","\tinc hl","endr","\tld a, [hli]","\tld d, [hl]","\tld e, a","\tpop hl","\tcall PlaceString","\tret",".none","\tpop de","\tret","",".GetMenuAccountTextPointer:","\tld e, a","\tld d, 0","\tld hl, wMenuDataPointerTableAddr","\tld a, [hli]","\tld h, [hl]","\tld l, a","rept 6","\tadd hl, de","endr","\tret","",".SetUpMenuItems:","\txor a","\tld [wWhichIndexSet], a","\tcall .FillMenuList","","\tld hl, wStatusFlags","\tbit STATUSFLAGS_POKEDEX_F, [hl]","\tjr z, .no_pokedex","\tld a, STARTMENUITEM_POKEDEX","\tcall .AppendMenuList",".no_pokedex","","\tld a, [wPartyCount]","\tand a","\tjr z, .no_pokemon","\tld a, STARTMENUITEM_POKEMON","\tcall .AppendMenuList",".no_pokemon","","\tld a, [wLinkMode]","\tand a","\tjr nz, .no_pack","\tld hl, wStatusFlags2","\tbit STATUSFLAGS2_BUG_CONTEST_TIMER_F, [hl]","\tjr nz, .no_pack","\tld a, STARTMENUITEM_PACK","\tcall .AppendMenuList",".no_pack","","\tld hl, wPokegearFlags","\tbit POKEGEAR_OBTAINED_F, [hl]","\tjr z, .no_pokegear","\tld a, STARTMENUITEM_POKEGEAR","\tcall .AppendMenuList",".no_pokegear","","\tld a, STARTMENUITEM_STATUS","\tcall .AppendMenuList","","\tld a, [wLinkMode]","\tand a","\tjr nz, .no_save","\tld hl, wStatusFlags2","\tbit STATUSFLAGS2_BUG_CONTEST_TIMER_F, [hl]","\tld a, STARTMENUITEM_QUIT","\tjr nz, .write","\tld a, STARTMENUITEM_SAVE",".write","\tcall .AppendMenuList",".no_save","","\tld a, STARTMENUITEM_OPTION","\tcall .AppendMenuList","\tld a, STARTMENUITEM_EXIT","\tcall .AppendMenuList","\tld a, c","\tld [wMenuItemsList], a","\tret","",".FillMenuList:","\txor a","\tld hl, wMenuItemsList","\tld [hli], a","\tld a, -1","\tld bc, wMenuItemsListEnd - (wMenuItemsList + 1)","\tcall ByteFill","\tld de, wMenuItemsList + 1","\tld c, 0","\tret","",".AppendMenuList:","\tld [de], a","\tinc de","\tinc c","\tret","",".DrawMenuAccount:","\tjp ._DrawMenuAccount","",".PrintMenuAccount:","\tcall .IsMenuAccountOn","\tret z","\tcall ._DrawMenuAccount","\tdecoord 0, 14","\tjp .MenuDesc","","._DrawMenuAccount:","\tcall .IsMenuAccountOn","\tret z","\thlcoord 0, 13","\tlb bc, 5, 10","\tcall ClearBox","\thlcoord 0, 13","\tld b, 3","\tld c, 8","\tjp TextboxPalette","",".IsMenuAccountOn:","\tld a, [wOptions2]","\tand 1 \u003c\u003c MENU_ACCOUNT","\tret","",".DrawBugContestStatusBox:","\tld hl, wStatusFlags2","\tbit STATUSFLAGS2_BUG_CONTEST_TIMER_F, [hl]","\tret z","\tfarcall StartMenu_DrawBugContestStatusBox","\tret","",".DrawBugContestStatus:","\tld hl, wStatusFlags2","\tbit STATUSFLAGS2_BUG_CONTEST_TIMER_F, [hl]","\tjr nz, .contest","\tret",".contest","\tfarcall StartMenu_PrintBugContestStatus","\tret"],"name":"StartMenu","file":"engine/menus/start_menu.asm","lineNo":13,"address":86008,"addressUsedBy":[]}