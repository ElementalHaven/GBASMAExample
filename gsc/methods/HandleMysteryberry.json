{"names":["HandleMysteryberry"],"callingMethods":["HandleBetweenTurnEffects"],"methodsCalled":["FarCall","GetItemName","GetOTPartymonItem","GetPartyLocation","GetPartymonItem","ItemRecoveryAnim","SetEnemyTurn","SetPlayerTurn","StdBattleTextbox","SwitchTurnCore"],"methodAddressesUsed":["GetUserItem"],"varsSet":["wNamedObjectIndexBuffer","wTempByteValue"],"varsUsed":["hBattleTurn","hSerialConnectionStatus","wBattleMode","wCurBattleMon","wCurOTMon","wEnemySubStatus5","wPlayerSubStatus5","wTempByteValue"],"varAddressesUsed":["BattleText_UserRecoveredPPUsing","wBattleMonMoves","wBattleMonPP","wEnemyMonMoves","wEnemyMonPP","wOTPartyMon1Moves","wOTPartyMon1PP","wPartyMon1Moves","wPartyMon1PP","wWildMonMoves","wWildMonPP"],"constantsUsed":[],"lines":["HandleMysteryberry:","\tldh a, [hSerialConnectionStatus]","\tcp USING_EXTERNAL_CLOCK","\tjr z, .DoEnemyFirst","\tcall SetPlayerTurn","\tcall .do_it","\tcall SetEnemyTurn","\tjp .do_it","",".DoEnemyFirst:","\tcall SetEnemyTurn","\tcall .do_it","\tcall SetPlayerTurn","",".do_it","\tcallfar GetUserItem","\tld a, b","\tcp HELD_RESTORE_PP","\tjr nz, .quit","\tld hl, wPartyMon1PP","\tld a, [wCurBattleMon]","\tcall GetPartyLocation","\tld d, h","\tld e, l","\tld hl, wPartyMon1Moves","\tld a, [wCurBattleMon]","\tcall GetPartyLocation","\tldh a, [hBattleTurn]","\tand a","\tjr z, .wild","\tld de, wWildMonPP","\tld hl, wWildMonMoves","\tld a, [wBattleMode]","\tdec a","\tjr z, .wild","\tld hl, wOTPartyMon1PP","\tld a, [wCurOTMon]","\tcall GetPartyLocation","\tld d, h","\tld e, l","\tld hl, wOTPartyMon1Moves","\tld a, [wCurOTMon]","\tcall GetPartyLocation","",".wild","\tld c, $0",".loop","\tld a, [hl]","\tand a","\tjr z, .quit","\tld a, [de]","\tand PP_MASK","\tjr z, .restore","\tinc hl","\tinc de","\tinc c","\tld a, c","\tcp NUM_MOVES","\tjr nz, .loop","",".quit","\tret","",".restore","\t; lousy hack","\tld a, [hl]","\tcp SKETCH","\tld b, 1","\tjr z, .sketch","\tld b, 5",".sketch","\tld a, [de]","\tadd b","\tld [de], a","\tpush bc","\tpush bc","\tld a, [hl]","\tld [wTempByteValue], a","\tld de, wBattleMonMoves - 1","\tld hl, wBattleMonPP","\tldh a, [hBattleTurn]","\tand a","\tjr z, .player_pp","\tld de, wEnemyMonMoves - 1","\tld hl, wEnemyMonPP",".player_pp","\tinc de","\tpop bc","\tld b, 0","\tadd hl, bc","\tpush hl","\tld h, d","\tld l, e","\tadd hl, bc","\tpop de","\tpop bc","","\tld a, [wTempByteValue]","\tcp [hl]","\tjr nz, .skip_checks","\tldh a, [hBattleTurn]","\tand a","\tld a, [wPlayerSubStatus5]","\tjr z, .check_transform","\tld a, [wEnemySubStatus5]",".check_transform","\tbit SUBSTATUS_TRANSFORMED, a","\tjr nz, .skip_checks","\tld a, [de]","\tadd b","\tld [de], a",".skip_checks","\tcallfar GetUserItem","\tld a, [hl]","\tld [wNamedObjectIndexBuffer], a","\txor a","\tld [hl], a","\tcall GetPartymonItem","\tldh a, [hBattleTurn]","\tand a","\tjr z, .consume_item","\tld a, [wBattleMode]","\tdec a","\tjr z, .skip_consumption","\tcall GetOTPartymonItem","",".consume_item","\txor a","\tld [hl], a","",".skip_consumption","\tcall GetItemName","\tcall SwitchTurnCore","\tcall ItemRecoveryAnim","\tcall SwitchTurnCore","\tld hl, BattleText_UserRecoveredPPUsing","\tjp StdBattleTextbox"],"name":"HandleMysteryberry","file":"engine/battle/core.asm","lineNo":1323,"address":135155,"addressUsedBy":[]}