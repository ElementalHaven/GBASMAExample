{"names":["InitSprites"],"callingMethods":["_UpdateSprites"],"methodsCalled":["ByteFill","DoesObjectHaveASprite"],"methodAddressesUsed":[],"varsSet":["hCurSpriteOAMFlags","hCurSpriteTile","hCurSpriteXPixel","hCurSpriteYPixel","hUsedSpriteIndex","hUsedSpriteTile"],"varsUsed":["hCurSpriteOAMFlags","hCurSpriteTile","hCurSpriteXPixel","hCurSpriteYPixel","hUsedSpriteIndex","hUsedSpriteTile","wPlayerBGMapOffsetX","wPlayerBGMapOffsetY"],"varAddressesUsed":["Facings","wObjectPriorities"],"constantsUsed":["NUM_OBJECT_STRUCTS","OBJECT_FACING_STEP","OBJECT_FLAGS2","OBJECT_LENGTH","OBJECT_PALETTE","OBJECT_SPRITE_TILE","OBJECT_SPRITE_X","OBJECT_SPRITE_X_OFFSET","OBJECT_SPRITE_Y","OBJECT_SPRITE_Y_OFFSET","PRIORITY_HIGH","PRIORITY_LOW","PRIORITY_NORM"],"lines":["InitSprites:","\tcall .DeterminePriorities","\tld c, PRIORITY_HIGH","\tcall .InitSpritesByPriority","\tld c, PRIORITY_NORM","\tcall .InitSpritesByPriority","\tld c, PRIORITY_LOW","\tcall .InitSpritesByPriority","\tret","",".DeterminePriorities:","\txor a","\tld hl, wObjectPriorities","\tld bc, NUM_OBJECT_STRUCTS","\tcall ByteFill","\tld d, 0","\tld bc, wObjectStructs","\tld hl, wObjectPriorities",".loop","\tpush hl","\tcall DoesObjectHaveASprite","\tjr z, .skip","\tld hl, OBJECT_FACING_STEP","\tadd hl, bc","\tld a, [hl]","\tcp STANDING","\tjr z, .skip","; Define the sprite priority.","\tld e, PRIORITY_LOW","\tld hl, OBJECT_FLAGS2","\tadd hl, bc","\tbit LOW_PRIORITY_F, [hl]","\tjr nz, .add","\tld e, PRIORITY_NORM","\tbit HIGH_PRIORITY_F, [hl]","\tjr z, .add","\tld e, PRIORITY_HIGH","\tjr .add","",".skip","\tld hl, OBJECT_LENGTH","\tadd hl, bc","\tld b, h","\tld c, l","\tpop hl","\tjr .next","",".add","\tld hl, OBJECT_LENGTH","\tadd hl, bc","\tld b, h","\tld c, l","\tpop hl","\tld a, d","\tor e","\tld [hli], a",".next","\tinc d","\tld a, d","\tcp NUM_OBJECT_STRUCTS","\tjr nz, .loop","\tret","",".InitSpritesByPriority:","\tld hl, wObjectPriorities",".next_sprite","\tld a, [hli]","\tld d, a","\tand $f0","\tret z","\tcp c","\tjr nz, .next_sprite","\tpush bc","\tpush hl","\tld a, d","\tand $f","\tcall .GetObjectStructPointer","\tcall .InitSprite","\tpop hl","\tpop bc","\tjr .next_sprite","",".InitSprite:","\tld hl, OBJECT_SPRITE_TILE","\tadd hl, bc","\tld a, [hl]","\tand $ff ^ (1 \u003c\u003c 7)","\tldh [hCurSpriteTile], a","\txor a","\tbit 7, [hl]","\tjr nz, .skip1","\tor VRAM_BANK_1",".skip1","\tld hl, OBJECT_FLAGS2","\tadd hl, bc","\tld e, [hl]","\tbit OBJ_FLAGS2_7, e","\tjr z, .skip2","\tor PRIORITY",".skip2","\tbit USE_OBP1_F, e","\tjr z, .skip3","\tor OBP_NUM",".skip3","\tld hl, OBJECT_PALETTE","\tadd hl, bc","\tld d, a","\tld a, [hl]","\tand PALETTE_MASK","\tor d","\tld d, a","\txor a","\tbit OVERHEAD_F, e","\tjr z, .skip4","\tor PRIORITY",".skip4","\tldh [hCurSpriteOAMFlags], a","\tld hl, OBJECT_SPRITE_X","\tadd hl, bc","\tld a, [hl]","\tld hl, OBJECT_SPRITE_X_OFFSET","\tadd hl, bc","\tadd [hl]","\tadd 8","\tld e, a","\tld a, [wPlayerBGMapOffsetX]","\tadd e","\tldh [hCurSpriteXPixel], a","\tld hl, OBJECT_SPRITE_Y","\tadd hl, bc","\tld a, [hl]","\tld hl, OBJECT_SPRITE_Y_OFFSET","\tadd hl, bc","\tadd [hl]","\tadd 12","\tld e, a","\tld a, [wPlayerBGMapOffsetY]","\tadd e","\tldh [hCurSpriteYPixel], a","\tld hl, OBJECT_FACING_STEP","\tadd hl, bc","\tld a, [hl]","\tcp STANDING","\tjp z, .done","\tcp NUM_FACINGS","\tjp nc, .done","\tld l, a","\tld h, 0","\tadd hl, hl","\tld bc, Facings","\tadd hl, bc","\tld a, [hli]","\tld h, [hl]","\tld l, a","\tldh a, [hUsedSpriteIndex]","\tld c, a","\tld b, HIGH(wVirtualOAM)","\tld a, [hli]","\tldh [hUsedSpriteTile], a","\tadd c","\tcp LOW(wVirtualOAMEnd)","\tjr nc, .full",".addsprite","\tldh a, [hCurSpriteYPixel]","\tadd [hl]","\tinc hl","\tld [bc], a ; y","\tinc c","\tldh a, [hCurSpriteXPixel]","\tadd [hl]","\tinc hl","\tld [bc], a ; x","\tinc c","\tld e, [hl]","\tinc hl","\tldh a, [hCurSpriteTile]","\tbit ABSOLUTE_TILE_ID_F, e","\tjr z, .nope1","\txor a",".nope1","\tadd [hl]","\tinc hl","\tld [bc], a ; tile id","\tinc c","\tld a, e","\tbit RELATIVE_ATTRIBUTES_F, a","\tjr z, .nope2","\tldh a, [hCurSpriteOAMFlags]","\tor e",".nope2","\tand OBP_NUM | X_FLIP | Y_FLIP | PRIORITY","\tor d","\tld [bc], a ; attributes","\tinc c","\tldh a, [hUsedSpriteTile]","\tdec a","\tldh [hUsedSpriteTile], a","\tjr nz, .addsprite","\tld a, c","\tldh [hUsedSpriteIndex], a",".done","\txor a","\tret","",".full","\tscf","\tret","",".GetObjectStructPointer:","\tld c, a","\tld b, 0","\tld hl, .Addresses","\tadd hl, bc","\tadd hl, bc","\tld c, [hl]","\tinc hl","\tld b, [hl]","\tret","",".Addresses:","\tdw wPlayerStruct","\tdw wObject1Struct","\tdw wObject2Struct","\tdw wObject3Struct","\tdw wObject4Struct","\tdw wObject5Struct","\tdw wObject6Struct","\tdw wObject7Struct","\tdw wObject8Struct","\tdw wObject9Struct","\tdw wObject10Struct","\tdw wObject11Struct","\tdw wObject12Struct"],"name":"InitSprites","file":"engine/overworld/map_objects.asm","lineNo":2772,"address":62649,"addressUsedBy":[]}