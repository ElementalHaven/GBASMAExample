{"names":["CheckAbleToSwitch"],"callingMethods":[],"methodsCalled":["CheckPlayerMoveTypeMatchups","FindAliveEnemyMons","FindAliveEnemyMonsWithASuperEffectiveMove","FindEnemyMonsImmuneToLastCounterMove","FindEnemyMonsThatResistPlayer","FindEnemyMonsWithASuperEffectiveMove","FindEnemyMonsWithAtLeastQuarterMaxHP"],"methodAddressesUsed":[],"varsSet":["wEnemySwitchMonParam"],"varsUsed":["wEnemyAISwitchScore","wEnemyPerishCount","wEnemySubStatus1","wLastPlayerCounterMove"],"varAddressesUsed":[],"constantsUsed":[],"lines":["CheckAbleToSwitch:","\txor a","\tld [wEnemySwitchMonParam], a","\tcall FindAliveEnemyMons","\tret c","","\tld a, [wEnemySubStatus1]","\tbit SUBSTATUS_PERISH, a","\tjr z, .no_perish","","\tld a, [wEnemyPerishCount]","\tcp 1","\tjr nz, .no_perish","","\t; Perish count is 1","","\tcall FindAliveEnemyMons","\tcall FindEnemyMonsWithAtLeastQuarterMaxHP","\tcall FindEnemyMonsThatResistPlayer","\tcall FindAliveEnemyMonsWithASuperEffectiveMove","","\tld a, e","\tcp 2","\tjr nz, .not_2","","\tld a, [wEnemyAISwitchScore]","\tadd $30 ; maximum chance","\tld [wEnemySwitchMonParam], a","\tret","",".not_2","\tcall FindAliveEnemyMons","\tsla c","\tsla c","\tld b, $ff","",".loop1","\tinc b","\tsla c","\tjr nc, .loop1","","\tld a, b","\tadd $30 ; maximum chance","\tld [wEnemySwitchMonParam], a","\tret","",".no_perish","\tcall CheckPlayerMoveTypeMatchups","\tld a, [wEnemyAISwitchScore]","\tcp 11","\tret nc","","\tld a, [wLastPlayerCounterMove]","\tand a","\tjr z, .no_last_counter_move","","\tcall FindEnemyMonsImmuneToLastCounterMove","\tld a, [wEnemyAISwitchScore]","\tand a","\tjr z, .no_last_counter_move","","\tld c, a","\tcall FindEnemyMonsWithASuperEffectiveMove","\tld a, [wEnemyAISwitchScore]","\tcp $ff","\tret z","","\tld b, a","\tld a, e","\tcp 2","\tjr z, .not_2_again","","\tcall CheckPlayerMoveTypeMatchups","\tld a, [wEnemyAISwitchScore]","\tcp 10","\tret nc","","\tld a, b","\tadd $10","\tld [wEnemySwitchMonParam], a","\tret","",".not_2_again","\tld c, $10","\tcall CheckPlayerMoveTypeMatchups","\tld a, [wEnemyAISwitchScore]","\tcp 10","\tjr nc, .okay","\tld c, $20","",".okay","\tld a, b","\tadd c","\tld [wEnemySwitchMonParam], a","\tret","",".no_last_counter_move","\tcall CheckPlayerMoveTypeMatchups","\tld a, [wEnemyAISwitchScore]","\tcp 10","\tret nc","","\tcall FindAliveEnemyMons","\tcall FindEnemyMonsWithAtLeastQuarterMaxHP","\tcall FindEnemyMonsThatResistPlayer","\tcall FindAliveEnemyMonsWithASuperEffectiveMove","","\tld a, e","\tcp $2","\tret nz","","\tld a, [wEnemyAISwitchScore]","\tadd $10","\tld [wEnemySwitchMonParam], a","\tret"],"name":"CheckAbleToSwitch","file":"engine/battle/ai/switch.asm","lineNo":176,"address":117581,"addressUsedBy":["SwitchRarely","SwitchOften","SwitchSometimes"]}