{"names":["Link_PrepPartyData_Gen2"],"callingMethods":["Gen2ToGen2LinkComms"],"methodsCalled":["CloseSRAM","CopyBytes","FarCall","Function28682","OpenSRAM"],"methodAddressesUsed":["ConvertFrenchGermanMailToEnglish","IsMailEuropean"],"varsSet":[],"varsUsed":["wLinkMode"],"varAddressesUsed":["sPartyMon1MailAuthor","wLinkData","wPartyCount","wPartyMon1Species","wPartyMonNicknames","wPartyMonOT","wPlayerID","wPlayerName","wc9f4","wc9f9","wcabf","wcb13"],"constantsUsed":["MAIL_MSG_LENGTH","MAIL_STRUCT_LENGTH","MON_NAME_LENGTH","NAME_LENGTH","PARTYMON_STRUCT_LENGTH","PARTY_LENGTH","SERIAL_PATCH_LIST_PART_TERMINATOR","SERIAL_PREAMBLE_BYTE"],"lines":["Link_PrepPartyData_Gen2:","\tld de, wLinkData","\tld a, SERIAL_PREAMBLE_BYTE","\tld b, PARTY_LENGTH",".loop1","\tld [de], a","\tinc de","\tdec b","\tjr nz, .loop1","\tld hl, wPlayerName","\tld bc, NAME_LENGTH","\tcall CopyBytes","\tld hl, wPartyCount","\tld bc, 1 + PARTY_LENGTH + 1","\tcall CopyBytes","\tld hl, wPlayerID","\tld bc, 2","\tcall CopyBytes","\tld hl, wPartyMon1Species","\tld bc, PARTY_LENGTH * PARTYMON_STRUCT_LENGTH","\tcall CopyBytes","\tld hl, wPartyMonOT","\tld bc, PARTY_LENGTH * NAME_LENGTH","\tcall CopyBytes","\tld hl, wPartyMonNicknames","\tld bc, PARTY_LENGTH * MON_NAME_LENGTH","\tcall CopyBytes","","; Okay, we did all that.  Now, are we in the trade center?","\tld a, [wLinkMode]","\tcp LINK_TRADECENTER","\tret nz","","; Fill 5 bytes at wc9f4 with $20","\tld de, wc9f4","\tld a, $20","\tcall Function28682","","; Copy all the mail messages to wc9f9","\tld a, BANK(sPartyMail)","\tcall OpenSRAM","\tld hl, sPartyMail","\tld b, PARTY_LENGTH",".loop2","\tpush bc","\tld bc, MAIL_MSG_LENGTH + 1","\tcall CopyBytes","\tld bc, sPartyMon1MailEnd - sPartyMon1MailAuthor","\tadd hl, bc","\tpop bc","\tdec b","\tjr nz, .loop2","; Copy the mail data to wcabf","\tld hl, sPartyMail","\tld b, PARTY_LENGTH",".loop3","\tpush bc","\tld bc, MAIL_MSG_LENGTH + 1","\tadd hl, bc","\tld bc, sPartyMon1MailEnd - sPartyMon1MailAuthor","\tcall CopyBytes","\tpop bc","\tdec b","\tjr nz, .loop3","","\tld b, PARTY_LENGTH","\tld de, sPartyMail","\tld hl, wc9f9",".loop4","\tpush bc","\tpush hl","\tpush de","\tpush hl","\tfarcall IsMailEuropean","\tpop de","\tld a, c","\tor a","\tjr z, .next","\tsub $3","\tjr nc, .italian_spanish","\tfarcall ConvertFrenchGermanMailToEnglish","\tjr .next","",".italian_spanish","\tcp $2","\tjr nc, .next","\tfarcall ConvertSpanishItalianMailToEnglish","",".next","\tpop de","\tld hl, MAIL_STRUCT_LENGTH","\tadd hl, de","\tld d, h","\tld e, l","\tpop hl","\tld bc, sPartyMon1MailAuthor - sPartyMon1Mail","\tadd hl, bc","\tpop bc","\tdec b","\tjr nz, .loop4","\tcall CloseSRAM","\tld hl, wc9f9","\tld bc, PARTY_LENGTH * (sPartyMon1MailAuthor - sPartyMon1Mail)",".loop5","\tld a, [hl]","\tcp SERIAL_NO_DATA_BYTE","\tjr nz, .skip2","\tld [hl], sPartyMon1MailAuthor - sPartyMon1Mail","",".skip2","\tinc hl","\tdec bc","\tld a, b","\tor c","\tjr nz, .loop5","\tld hl, wcabf","\tld de, wcb13","\tld b, PARTY_LENGTH * (sPartyMon1MailEnd - sPartyMon1MailAuthor)","\tld c, $0",".loop6","\tinc c","\tld a, [hl]","\tcp SERIAL_NO_DATA_BYTE","\tjr nz, .skip3","\tld [hl], SERIAL_PATCH_LIST_PART_TERMINATOR","\tld a, c","\tld [de], a","\tinc de","",".skip3","\tinc hl","\tdec b","\tjr nz, .loop6","\tld a, SERIAL_PATCH_LIST_PART_TERMINATOR","\tld [de], a","\tret"],"name":"Link_PrepPartyData_Gen2","file":"engine/link/link.asm","lineNo":798,"address":103045,"addressUsedBy":[]}