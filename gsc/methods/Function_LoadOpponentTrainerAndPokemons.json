{"names":["Function_LoadOpponentTrainerAndPokemons"],"callingMethods":[],"methodsCalled":["AddNTimes","ByteFill","CloseSRAM","CopyBytes","Function_LoadRandomBattleTowerMon","GetFarByte","OpenSRAM","Random"],"methodAddressesUsed":[],"varsSet":["rSVBK","wBT_OTMon1Item","wBT_OTMon2Item","wBT_OTMon3Item"],"varsUsed":["hRandomAdd","rSVBK","sNrOfBeatenBattleTowerTrainers"],"varAddressesUsed":["BattleTowerTrainers","sBTTrainers"],"constantsUsed":["BATTLETOWER_STREAK_LENGTH","BATTLETOWER_TRAINERDATALENGTH","BATTLE_TOWER_STRUCT_LENGTH","NAME_LENGTH"],"lines":["Function_LoadOpponentTrainerAndPokemons:","\tldh a, [rSVBK]","\tpush af","\tld a, BANK(wBT_OTTrainer)","\tldh [rSVBK], a","","\t; Fill wBT_OTTrainer with zeros","\txor a","\tld hl, wBT_OTTrainer","\tld bc, BATTLE_TOWER_STRUCT_LENGTH","\tcall ByteFill","","\t; Write $ff into the Item-Slots","\tld a, $ff","\tld [wBT_OTMon1Item], a","\tld [wBT_OTMon2Item], a","\tld [wBT_OTMon3Item], a","","\t; Set wBT_OTTrainer as start address to write the following data to","\tld de, wBT_OTTrainer","","\tldh a, [hRandomAdd]","\tld b, a",".resample ; loop to find a random trainer","\tcall Random","\tldh a, [hRandomAdd]","\tadd b","\tld b, a ; b contains the nr of the trainer","if DEF(_CRYSTAL11)","\tmaskbits BATTLETOWER_NUM_UNIQUE_TRAINERS","\tcp BATTLETOWER_NUM_UNIQUE_TRAINERS","else","; Crystal 1.0 used the wrong constant here, so only the first 21","; trainers in BattleTowerTrainers can be sampled.","\tmaskbits BATTLETOWER_NUM_UNIQUE_MON","\tcp BATTLETOWER_NUM_UNIQUE_MON","endc","\tjr nc, .resample","\tld b, a","","\tld a, BANK(sBTTrainers)","\tcall OpenSRAM","","\tld c, BATTLETOWER_STREAK_LENGTH","\tld hl, sBTTrainers",".next_trainer","\tld a, [hli]","\tcp b","\tjr z, .resample","\tdec c","\tjr nz, .next_trainer ; c \u003c\u003d 7  initialise all 7 trainers?","","\tld hl, sBTTrainers","\tld a, [sNrOfBeatenBattleTowerTrainers]","\tld c, a","\tld a, b","\tld b, 0","\tadd hl, bc","\tld [hl], a","","\tcall CloseSRAM","","\tpush af","; Copy name (10 bytes) and class (1 byte) of trainer","\tld hl, BattleTowerTrainers","\tld bc, NAME_LENGTH","\tcall AddNTimes","\tld bc, NAME_LENGTH","\tcall CopyBytes","","\tcall Function_LoadRandomBattleTowerMon","\tpop af","","\tld hl, BattleTowerTrainerData","\tld bc, BATTLETOWER_TRAINERDATALENGTH","\tcall AddNTimes","\tld bc, BATTLETOWER_TRAINERDATALENGTH",".copy_bt_trainer_data_loop","\tld a, BANK(BattleTowerTrainerData)","\tcall GetFarByte","\tld [de], a","\tinc hl","\tinc de","\tdec bc","\tld a, b","\tor c","\tjr nz, .copy_bt_trainer_data_loop","","\tpop af","\tldh [rSVBK], a","","\tret"],"name":"Function_LoadOpponentTrainerAndPokemons","file":"engine/events/battle_tower/load_trainer.asm","lineNo":1,"address":315166,"addressUsedBy":["LoadOpponentTrainerAndPokemonWithOTSprite"]}