{"names":["Gen2ToGen1LinkComms"],"callingMethods":["LinkCommunications","LinkTrade"],"methodsCalled":["ClearLinkData","CopyBytes","DelayFrame","DelayFrames","FarCall","FixDataForLinkTransfer","Function2868a","Function28b22","InitTradeMenuDisplay","Link_CopyOTData","Link_CopyRandomNumbers","Link_FindFirstNonControlCharacter_SkipZero","Link_PrepPartyData_Gen1","PlayMusic","Serial_ExchangeBytes","WaitLinkTransfer"],"methodAddressesUsed":["ConvertMon_1to2"],"varsSet":["hSerialSend","rIE","rIF","rSC","wPlayerLinkAction","wTempSpecies","wUnusedD102"],"varsUsed":["hSerialConnectionStatus","wTempSpecies"],"varAddressesUsed":["wEnemyMonSpecies","wLinkData","wLinkPlayerName","wLink_c608","wOTPartyCount","wOTPartyMonOT","wOTPlayerName","wPlayerTrademonSpecies","wTimeCapsulePartyMon1Species","wd1f3"],"constantsUsed":["JOYPAD","MUSIC_NONE","MUSIC_ROUTE_30","NAME_LENGTH","SERIAL","SERIAL_NO_DATA_BYTE","TIMER","VBLANK","rSC_CLOCK","rSC_ON"],"lines":["Gen2ToGen1LinkComms:","\tcall ClearLinkData","\tcall Link_PrepPartyData_Gen1","\tcall FixDataForLinkTransfer","\txor a","\tld [wPlayerLinkAction], a","\tcall WaitLinkTransfer","\tldh a, [hSerialConnectionStatus]","\tcp USING_INTERNAL_CLOCK","\tjr nz, .player_1","","\tld c, 3","\tcall DelayFrames","\txor a","\tldh [hSerialSend], a","\tld a, (0 \u003c\u003c rSC_ON) | (1 \u003c\u003c rSC_CLOCK)","\tldh [rSC], a","\tld a, (1 \u003c\u003c rSC_ON) | (1 \u003c\u003c rSC_CLOCK)","\tldh [rSC], a","","\tcall DelayFrame","\txor a","\tldh [hSerialSend], a","\tld a, (0 \u003c\u003c rSC_ON) | (1 \u003c\u003c rSC_CLOCK)","\tldh [rSC], a","\tld a, (1 \u003c\u003c rSC_ON) | (1 \u003c\u003c rSC_CLOCK)","\tldh [rSC], a","",".player_1","\tld de, MUSIC_NONE","\tcall PlayMusic","\tld c, 3","\tcall DelayFrames","\txor a","\tldh [rIF], a","\tld a, 1 \u003c\u003c SERIAL","\tldh [rIE], a","\tld hl, wd1f3","\tld de, wEnemyMonSpecies","\tld bc, $11","\tcall Serial_ExchangeBytes","\tld a, SERIAL_NO_DATA_BYTE","\tld [de], a","\tld hl, wLinkData","\tld de, wOTPlayerName","\tld bc, $1a8","\tcall Serial_ExchangeBytes","\tld a, SERIAL_NO_DATA_BYTE","\tld [de], a","\tld hl, wLink_c608","\tld de, wTrademons","\tld bc, wTrademons - wLink_c608","\tcall Serial_ExchangeBytes","\txor a","\tldh [rIF], a","\tld a, (1 \u003c\u003c JOYPAD) | (1 \u003c\u003c SERIAL) | (1 \u003c\u003c TIMER) | (1 \u003c\u003c VBLANK)","\tldh [rIE], a","\tcall Link_CopyRandomNumbers","\tld hl, wOTPlayerName","\tcall Link_FindFirstNonControlCharacter_SkipZero","\tpush hl","\tld bc, NAME_LENGTH","\tadd hl, bc","\tld a, [hl]","\tpop hl","\tand a","\tjp z, Function28b22","\tcp $7","\tjp nc, Function28b22","\tld de, wLinkData","\tld bc, $1a2","\tcall Link_CopyOTData","\tld de, wPlayerTrademonSpecies","\tld hl, wTimeCapsulePartyMon1Species","\tld c, 2",".loop","\tld a, [de]","\tinc de","\tand a","\tjr z, .loop","\tcp SERIAL_PREAMBLE_BYTE","\tjr z, .loop","\tcp SERIAL_NO_DATA_BYTE","\tjr z, .loop","\tcp SERIAL_PATCH_LIST_PART_TERMINATOR","\tjr z, .next","\tpush hl","\tpush bc","\tld b, 0","\tdec a","\tld c, a","\tadd hl, bc","\tld a, SERIAL_NO_DATA_BYTE","\tld [hl], a","\tpop bc","\tpop hl","\tjr .loop","",".next","\tld hl, wc90f","\tdec c","\tjr nz, .loop","\tld hl, wLinkPlayerName","\tld de, wOTPlayerName","\tld bc, NAME_LENGTH","\tcall CopyBytes","\tld de, wOTPartyCount","\tld a, [hli]","\tld [de], a","\tinc de",".party_loop","\tld a, [hli]","\tcp -1","\tjr z, .done_party","\tld [wTempSpecies], a","\tpush hl","\tpush de","\tcallfar ConvertMon_1to2","\tpop de","\tpop hl","\tld a, [wTempSpecies]","\tld [de], a","\tinc de","\tjr .party_loop","",".done_party","\tld [de], a","\tld hl, wTimeCapsulePartyMon1Species","\tcall Function2868a","\tld a, LOW(wOTPartyMonOT)","\tld [wUnusedD102], a","\tld a, HIGH(wOTPartyMonOT)","\tld [wUnusedD102 + 1], a","\tld de, MUSIC_NONE","\tcall PlayMusic","\tldh a, [hSerialConnectionStatus]","\tcp USING_INTERNAL_CLOCK","\tld c, 66","\tcall z, DelayFrames","\tld de, MUSIC_ROUTE_30","\tcall PlayMusic","\tjp InitTradeMenuDisplay"],"name":"Gen2ToGen1LinkComms","file":"engine/link/link.asm","lineNo":38,"address":102347,"addressUsedBy":[]}