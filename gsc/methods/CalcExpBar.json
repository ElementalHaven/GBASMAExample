{"names":["CalcExpBar"],"callingMethods":["AnimateExpBar","FillInExpBar"],"methodsCalled":["Divide","FarCall","Multiply"],"methodAddressesUsed":["CalcExpAtLevel"],"varsSet":["hDivisor","hMathBuffer","hMultiplier"],"varsUsed":["hMathBuffer","hQuotient"],"varAddressesUsed":["hMultiplicand","hProduct"],"constantsUsed":[],"lines":["CalcExpBar:","; Calculate the percent exp between this level and the next","; Level in b","\tpush de","\tld d, b","\tpush de","\tcallfar CalcExpAtLevel","\tpop de","; exp at current level gets pushed to the stack","\tld hl, hMultiplicand","\tld a, [hli]","\tpush af","\tld a, [hli]","\tpush af","\tld a, [hl]","\tpush af","; next level","\tinc d","\tcallfar CalcExpAtLevel","; back up the next level exp, and subtract the two levels","\tld hl, hMultiplicand + 2","\tld a, [hl]","\tldh [hMathBuffer + 2], a","\tpop bc","\tsub b","\tld [hld], a","\tld a, [hl]","\tldh [hMathBuffer + 1], a","\tpop bc","\tsbc b","\tld [hld], a","\tld a, [hl]","\tldh [hMathBuffer], a","\tpop bc","\tsbc b","\tld [hl], a","\tpop de","","\tld hl, hMultiplicand + 1","\tld a, [hli]","\tpush af","\tld a, [hl]","\tpush af","","; get the amount of exp remaining to the next level","\tld a, [de]","\tdec de","\tld c, a","\tldh a, [hMathBuffer + 2]","\tsub c","\tld [hld], a","\tld a, [de]","\tdec de","\tld b, a","\tldh a, [hMathBuffer + 1]","\tsbc b","\tld [hld], a","\tld a, [de]","\tld c, a","\tldh a, [hMathBuffer]","\tsbc c","\tld [hld], a","\txor a","\tld [hl], a","\tld a, 64","\tldh [hMultiplier], a","\tcall Multiply","\tpop af","\tld c, a","\tpop af","\tld b, a",".loop","\tld a, b","\tand a","\tjr z, .done","\tsrl b","\trr c","\tld hl, hProduct","\tsrl [hl]","\tinc hl","\trr [hl]","\tinc hl","\trr [hl]","\tinc hl","\trr [hl]","\tjr .loop","",".done","\tld a, c","\tldh [hDivisor], a","\tld b, 4","\tcall Divide","\tldh a, [hQuotient + 3]","\tld b, a","\tld a, $40","\tsub b","\tld b, a","\tret"],"name":"CalcExpBar","file":"engine/battle/core.asm","lineNo":7813,"address":140472,"addressUsedBy":[]}