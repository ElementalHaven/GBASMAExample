{"names":["BattleCommand_Critical"],"callingMethods":[],"methodsCalled":["BattleRandom","GetBattleVar","GetUserItem","IsInArray"],"methodAddressesUsed":[],"varsSet":["wCriticalHit"],"varsUsed":["hBattleTurn","wBattleMonSpecies","wEnemyMonSpecies"],"varAddressesUsed":["CriticalHitChances","CriticalHitMoves","wBattleMonItem","wEnemyMonItem"],"constantsUsed":["BATTLE_VARS_MOVE_ANIM","BATTLE_VARS_MOVE_POWER","BATTLE_VARS_SUBSTATUS4"],"lines":["BattleCommand_Critical:","; critical","","; Determine whether this attack\u0027s hit will be critical.","","\txor a","\tld [wCriticalHit], a","","\tld a, BATTLE_VARS_MOVE_POWER","\tcall GetBattleVar","\tand a","\tret z","","\tldh a, [hBattleTurn]","\tand a","\tld hl, wEnemyMonItem","\tld a, [wEnemyMonSpecies]","\tjr nz, .Item","\tld hl, wBattleMonItem","\tld a, [wBattleMonSpecies]","",".Item:","\tld c, 0","","\tcp CHANSEY","\tjr nz, .Farfetchd","\tld a, [hl]","\tcp LUCKY_PUNCH","\tjr nz, .FocusEnergy","","; +2 critical level","\tld c, 2","\tjr .Tally","",".Farfetchd:","\tcp FARFETCH_D","\tjr nz, .FocusEnergy","\tld a, [hl]","\tcp STICK","\tjr nz, .FocusEnergy","","; +2 critical level","\tld c, 2","\tjr .Tally","",".FocusEnergy:","\tld a, BATTLE_VARS_SUBSTATUS4","\tcall GetBattleVar","\tbit SUBSTATUS_FOCUS_ENERGY, a","\tjr z, .CheckCritical","","; +1 critical level","\tinc c","",".CheckCritical:","\tld a, BATTLE_VARS_MOVE_ANIM","\tcall GetBattleVar","\tld de, 1","\tld hl, CriticalHitMoves","\tpush bc","\tcall IsInArray","\tpop bc","\tjr nc, .ScopeLens","","; +2 critical level","\tinc c","\tinc c","",".ScopeLens:","\tpush bc","\tcall GetUserItem","\tld a, b","\tcp HELD_CRITICAL_UP ; Increased critical chance. Only Scope Lens has this.","\tpop bc","\tjr nz, .Tally","","; +1 critical level","\tinc c","",".Tally:","\tld hl, CriticalHitChances","\tld b, 0","\tadd hl, bc","\tcall BattleRandom","\tcp [hl]","\tret nc","\tld a, 1","\tld [wCriticalHit], a","\tret"],"name":"BattleCommand_Critical","file":"engine/battle/effect_commands.asm","lineNo":1125,"address":117138,"addressUsedBy":[]}