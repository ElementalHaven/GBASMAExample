{"names":["FindEnemyMonsWithASuperEffectiveMove"],"callingMethods":["CheckAbleToSwitch","FindAliveEnemyMonsWithASuperEffectiveMove"],"methodsCalled":["CheckTypeMatchup","GetMoveAttr","GetMoveByte"],"methodAddressesUsed":[],"varsSet":["wEnemyAISwitchScore"],"varsUsed":["wTypeMatchup"],"varAddressesUsed":["Moves","wBattleMonType1","wOTPartyMon1Moves"],"constantsUsed":["MOVE_POWER","NUM_MOVES","PARTYMON_STRUCT_LENGTH","PARTY_LENGTH"],"lines":["FindEnemyMonsWithASuperEffectiveMove:","\tld a, -1","\tld [wEnemyAISwitchScore], a","\tld hl, wOTPartyMon1Moves","\tld b, 1 \u003c\u003c (PARTY_LENGTH - 1)","\tld d, 0","\tld e, 0",".loop","\tld a, b","\tand c","\tjr z, .next","","\tpush hl","\tpush bc","\t; for move on mon:","\tld b, NUM_MOVES","\tld c, 0",".loop3","\t; if move is None: break","\tld a, [hli]","\tand a","\tpush hl","\tjr z, .break3","","\t; if move has no power: continue","\tdec a","\tld hl, Moves + MOVE_POWER","\tcall GetMoveAttr","\tand a","\tjr z, .nope","","\t; check type matchups","\tinc hl","\tcall GetMoveByte","\tld hl, wBattleMonType1","\tcall CheckTypeMatchup","","\t; if immune or not very effective: continue","\tld a, [wTypeMatchup]","\tcp 10","\tjr c, .nope","","\t; if neutral: load 1 and continue","\tld e, 1","\tcp EFFECTIVE + 1","\tjr c, .nope","","\t; if super-effective: load 2 and break","\tld e, 2","\tjr .break3","",".nope","\tpop hl","\tdec b","\tjr nz, .loop3","","\tjr .done","",".break3","\tpop hl",".done","\tld a, e","\tpop bc","\tpop hl","\tcp 2","\tjr z, .done2 ; at least one move is super-effective","\tcp 1","\tjr nz, .next ; no move does more than half damage","","\t; encourage this pokemon","\tld a, d","\tor b","\tld d, a","\tjr .next ; such a long jump","",".next","\t; next pokemon?","\tpush bc","\tld bc, PARTYMON_STRUCT_LENGTH","\tadd hl, bc","\tpop bc","\tsrl b","\tjr nc, .loop","","\t; if no pokemon has a super-effective move: return","\tld a, d","\tld b, a","\tand a","\tret z","",".done2","\t; convert the bit flag to an int and return","\tpush bc","\tsla b","\tsla b","\tld c, $ff",".loop2","\tinc c","\tsla b","\tjr nc, .loop2","","\tld a, c","\tld [wEnemyAISwitchScore], a","\tpop bc","\tret"],"name":"FindEnemyMonsWithASuperEffectiveMove","file":"engine/battle/ai/switch.asm","lineNo":440,"address":117774,"addressUsedBy":[]}