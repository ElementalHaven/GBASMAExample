{"names":["AddLastLinkBattleToLinkRecord"],"callingMethods":["DisplayLinkBattleResult"],"methodsCalled":["AddNTimes","CompareBytes","CompareBytesLong","CopyBytes"],"methodAddressesUsed":[],"varsSet":[],"varsUsed":["wBattleResult"],"varAddressesUsed":["sLinkBattleRecord1Draws","sLinkBattleRecord1Losses","sLinkBattleRecord1Wins","wOTPlayerID","wOTPlayerName","wStringBuffer1","wd002"],"constantsUsed":["LINK_BATTLE_RECORD_LENGTH","NAME_LENGTH","NUM_LINK_BATTLE_RECORDS"],"lines":["AddLastLinkBattleToLinkRecord:","\tld hl, wOTPlayerID","\tld de, wStringBuffer1","\tld bc, 2","\tcall CopyBytes","\tld hl, wOTPlayerName","\tld bc, NAME_LENGTH - 1","\tcall CopyBytes","\tld hl, sLinkBattleStats - (LINK_BATTLE_RECORD_LENGTH - 6)","\tcall .StoreResult","\tld hl, sLinkBattleRecord","\tld d, NUM_LINK_BATTLE_RECORDS",".loop","\tpush hl","\tinc hl","\tinc hl","\tld a, [hl]","\tdec hl","\tdec hl","\tand a","\tjr z, .copy","\tpush de","\tld bc, LINK_BATTLE_RECORD_LENGTH - 6","\tld de, wStringBuffer1","\tcall CompareBytesLong","\tpop de","\tpop hl","\tjr c, .done","\tld bc, LINK_BATTLE_RECORD_LENGTH","\tadd hl, bc","\tdec d","\tjr nz, .loop","\tld bc, -LINK_BATTLE_RECORD_LENGTH","\tadd hl, bc","\tpush hl","",".copy","\tld d, h","\tld e, l","\tld hl, wStringBuffer1","\tld bc, LINK_BATTLE_RECORD_LENGTH - 6","\tcall CopyBytes","\tld b, 6","\txor a",".loop2","\tld [de], a","\tinc de","\tdec b","\tjr nz, .loop2","\tpop hl","",".done","\tcall .StoreResult","\tcall .FindOpponentAndAppendRecord","\tret","",".StoreResult:","\tld a, [wBattleResult]","\tand $f","\tcp LOSE","\tld bc, (sLinkBattleRecord1Wins - sLinkBattleRecord1) + 1","\tjr c, .okay ; WIN","\tld bc, (sLinkBattleRecord1Losses - sLinkBattleRecord1) + 1","\tjr z, .okay ; LOSE","\t; DRAW","\tld bc, (sLinkBattleRecord1Draws - sLinkBattleRecord1) + 1",".okay","\tadd hl, bc","\tcall .CheckOverflow","\tret nc","\tinc [hl]","\tret nz","\tdec hl","\tinc [hl]","\tret","",".CheckOverflow:","\tdec hl","\tld a, [hl]","\tinc hl","\tcp HIGH(MAX_LINK_RECORD)","\tret c","\tld a, [hl]","\tcp LOW(MAX_LINK_RECORD)","\tret","",".FindOpponentAndAppendRecord:","\tld b, NUM_LINK_BATTLE_RECORDS","\tld hl, sLinkBattleRecord1End - 1","\tld de, wd002",".loop3","\tpush bc","\tpush de","\tpush hl","\tcall .LoadPointer","\tpop hl","\tld a, e","\tpop de","\tld [de], a","\tinc de","\tld a, b","\tld [de], a","\tinc de","\tld a, c","\tld [de], a","\tinc de","\tld bc, LINK_BATTLE_RECORD_LENGTH","\tadd hl, bc","\tpop bc","\tdec b","\tjr nz, .loop3","\tld b, $0","\tld c, $1",".loop4","\tld a, b","\tadd b","\tadd b","\tld e, a","\tld d, $0","\tld hl, wd002","\tadd hl, de","\tpush hl","\tld a, c","\tadd c","\tadd c","\tld e, a","\tld d, $0","\tld hl, wd002","\tadd hl, de","\tld d, h","\tld e, l","\tpop hl","\tpush bc","\tld c, 3","\tcall CompareBytes","\tpop bc","\tjr z, .equal","\tjr nc, .done2","",".equal","\tinc c","\tld a, c","\tcp $5","\tjr nz, .loop4","\tinc b","\tld c, b","\tinc c","\tld a, b","\tcp $4","\tjr nz, .loop4","\tret","",".done2","\tpush bc","\tld a, b","\tld bc, LINK_BATTLE_RECORD_LENGTH","\tld hl, sLinkBattleRecord","\tcall AddNTimes","\tpush hl","\tld de, wd002","\tld bc, LINK_BATTLE_RECORD_LENGTH","\tcall CopyBytes","\tpop hl","\tpop bc","\tpush hl","\tld a, c","\tld bc, LINK_BATTLE_RECORD_LENGTH","\tld hl, sLinkBattleRecord","\tcall AddNTimes","\tpop de","\tpush hl","\tld bc, LINK_BATTLE_RECORD_LENGTH","\tcall CopyBytes","\tld hl, wd002","\tld bc, LINK_BATTLE_RECORD_LENGTH","\tpop de","\tcall CopyBytes","\tret","",".LoadPointer:","\tld e, $0","\tld a, [hld]","\tld c, a","\tld a, [hld]","\tld b, a","\tld a, [hld]","\tadd c","\tld c, a","\tld a, [hld]","\tadc b","\tld b, a","\tjr nc, .okay2","\tinc e","",".okay2","\tld a, [hld]","\tadd c","\tld c, a","\tld a, [hl]","\tadc b","\tld b, a","\tret nc","\tinc e","\tret"],"name":"AddLastLinkBattleToLinkRecord","file":"engine/battle/core.asm","lineNo":8699,"address":141368,"addressUsedBy":[]}