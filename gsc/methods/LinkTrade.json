{"names":["LinkTrade"],"callingMethods":["Function28926"],"methodsCalled":["AddNTimes","Call_ExitMenu","ClearScreen","ClearTilemap","CloseSRAM","CopyBytes","DelayFrames","FarCall","Function28ea3","Gen2ToGen1LinkComms","Gen2ToGen2LinkComms","GetPartyLocation","GetPokemonName","GetSGBLayout","LinkTextboxAtHL","LoadFontsBattleExtra","LoadStandardMenuHeader","LoadTradeScreenBorder","OpenSRAM","PlaceHLTextAtBC","PlaceString","Predef","ScrollingMenuJoypad","Serial_PrintWaitingTextAndSyncAndExchangeNybble","SetTradeRoomBGPals","SkipNames","WaitBGMap2"],"methodAddressesUsed":["BackupMobileEventIndex","EvolvePokemon","Function16d6ce","GetCaughtGender","Link_WaitBGMap","RemoveMonFromPartyOrBox","SaveAfterLinkTrade","StubbedTrainerRankings_Trades"],"varsSet":["w2DMenuCursorInitX","w2DMenuCursorInitY","w2DMenuCursorOffsets","w2DMenuFlags1","w2DMenuFlags2","w2DMenuNumCols","w2DMenuNumRows","wCurPartyMon","wCurPartySpecies","wForceEvolution","wMenuCursorX","wMenuCursorY","wMenuJoypadFilter","wNamedObjectIndexBuffer","wOTTrademonCaughtData","wOTTrademonDVs","wOTTrademonID","wOTTrademonSpecies","wOtherPlayerLinkAction","wPlayerLinkAction","wPlayerTrademonCaughtData","wPlayerTrademonDVs","wPlayerTrademonID","wPlayerTrademonSpecies","wPokemonWithdrawDepositParameter","wcf57","wd002","wd003"],"varsUsed":["hSerialConnectionStatus","wCurPartySpecies","wLinkMode","wMenuCursorY","wOtherPlayerLinkAction","wOtherPlayerLinkMode","wPartyCount","wd002","wd003"],"varAddressesUsed":["AddTempmonToPartyPredef","LinkAskTradeForText","String28eab","String28ebd","String_TooBadTheTradeWasCanceled","TradeAnimationPlayer2Predef","TradeAnimationPredef","wOTPartyMon1DVs","wOTPartyMon1ID","wOTPartyMon1Species","wOTPartyMonOT","wOTPartySpecies","wOTPlayerName","wOTTrademonOTName","wOTTrademonSenderName","wPartyMon1DVs","wPartyMon1ID","wPartyMon1Species","wPartyMonOT","wPartySpecies","wPlayerName","wPlayerTrademonOTName","wPlayerTrademonSenderName","wStringBuffer1","wTempMonSpecies","wc9f4","wd004"],"constantsUsed":["A_BUTTON","B_BUTTON","MAIL_STRUCT_LENGTH","MON_NAME_LENGTH","NAME_LENGTH","PARTYMON_STRUCT_LENGTH","SCGB_DIPLOMA","TRUE"],"lines":["LinkTrade:","\txor a","\tld [wcf57], a","\tld [wOtherPlayerLinkAction], a","\thlcoord 0, 12","\tld b, 4","\tld c, 18","\tcall LinkTextboxAtHL","\tfarcall Link_WaitBGMap","\tld a, [wd002]","\tld hl, wPartySpecies","\tld c, a","\tld b, 0","\tadd hl, bc","\tld a, [hl]","\tld [wNamedObjectIndexBuffer], a","\tcall GetPokemonName","\tld hl, wStringBuffer1","\tld de, wd004","\tld bc, MON_NAME_LENGTH","\tcall CopyBytes","\tld a, [wd003]","\tld hl, wOTPartySpecies","\tld c, a","\tld b, 0","\tadd hl, bc","\tld a, [hl]","\tld [wNamedObjectIndexBuffer], a","\tcall GetPokemonName","\tld hl, LinkAskTradeForText","\tbccoord 1, 14","\tcall PlaceHLTextAtBC","\tcall LoadStandardMenuHeader","\thlcoord 10, 7","\tld b, 3","\tld c, 7","\tcall LinkTextboxAtHL","\tld de, String28eab","\thlcoord 12, 8","\tcall PlaceString","\tld a, 8","\tld [w2DMenuCursorInitY], a","\tld a, 11","\tld [w2DMenuCursorInitX], a","\tld a, 1","\tld [w2DMenuNumCols], a","\tld a, 2","\tld [w2DMenuNumRows], a","\txor a","\tld [w2DMenuFlags1], a","\tld [w2DMenuFlags2], a","\tld a, $20","\tld [w2DMenuCursorOffsets], a","\tld a, A_BUTTON | B_BUTTON","\tld [wMenuJoypadFilter], a","\tld a, 1","\tld [wMenuCursorY], a","\tld [wMenuCursorX], a","\tfarcall Link_WaitBGMap","\tcall ScrollingMenuJoypad","\tpush af","\tcall Call_ExitMenu","\tcall WaitBGMap2","\tpop af","\tbit 1, a","\tjr nz, .asm_28c33","\tld a, [wMenuCursorY]","\tdec a","\tjr z, .asm_28c54","",".asm_28c33","\tld a, $1","\tld [wPlayerLinkAction], a","\thlcoord 0, 12","\tld b, 4","\tld c, 18","\tcall LinkTextboxAtHL","\thlcoord 1, 14","\tld de, String_TooBadTheTradeWasCanceled","\tcall PlaceString","\tfarcall Function16d6ce","\tjp Function28ea3","",".asm_28c54","\tld a, $2","\tld [wPlayerLinkAction], a","\tfarcall Function16d6ce","\tld a, [wOtherPlayerLinkMode]","\tdec a","\tjr nz, .asm_28c7b","\thlcoord 0, 12","\tld b, 4","\tld c, 18","\tcall LinkTextboxAtHL","\thlcoord 1, 14","\tld de, String_TooBadTheTradeWasCanceled","\tcall PlaceString","\tjp Function28ea3","",".asm_28c7b","\tld hl, sPartyMail","\tld a, [wd002]","\tld bc, MAIL_STRUCT_LENGTH","\tcall AddNTimes","\tld a, BANK(sPartyMail)","\tcall OpenSRAM","\tld d, h","\tld e, l","\tld bc, MAIL_STRUCT_LENGTH","\tadd hl, bc","\tld a, [wd002]","\tld c, a",".asm_28c96","\tinc c","\tld a, c","\tcp PARTY_LENGTH","\tjr z, .asm_28ca6","\tpush bc","\tld bc, MAIL_STRUCT_LENGTH","\tcall CopyBytes","\tpop bc","\tjr .asm_28c96","",".asm_28ca6","\tld hl, sPartyMail","\tld a, [wPartyCount]","\tdec a","\tld bc, MAIL_STRUCT_LENGTH","\tcall AddNTimes","\tpush hl","\tld hl, wc9f4","\tld a, [wd003]","\tld bc, MAIL_STRUCT_LENGTH","\tcall AddNTimes","\tpop de","\tld bc, MAIL_STRUCT_LENGTH","\tcall CopyBytes","\tcall CloseSRAM","\tld hl, wPlayerName","\tld de, wPlayerTrademonSenderName","\tld bc, NAME_LENGTH","\tcall CopyBytes","\tld a, [wd002]","\tld hl, wPartySpecies","\tld b, 0","\tld c, a","\tadd hl, bc","\tld a, [hl]","\tld [wPlayerTrademonSpecies], a","\tpush af","\tld a, [wd002]","\tld hl, wPartyMonOT","\tcall SkipNames","\tld de, wPlayerTrademonOTName","\tld bc, NAME_LENGTH","\tcall CopyBytes","\tld hl, wPartyMon1ID","\tld a, [wd002]","\tcall GetPartyLocation","\tld a, [hli]","\tld [wPlayerTrademonID], a","\tld a, [hl]","\tld [wPlayerTrademonID + 1], a","\tld hl, wPartyMon1DVs","\tld a, [wd002]","\tcall GetPartyLocation","\tld a, [hli]","\tld [wPlayerTrademonDVs], a","\tld a, [hl]","\tld [wPlayerTrademonDVs + 1], a","\tld a, [wd002]","\tld hl, wPartyMon1Species","\tcall GetPartyLocation","\tld b, h","\tld c, l","\tfarcall GetCaughtGender","\tld a, c","\tld [wPlayerTrademonCaughtData], a","\tld hl, wOTPlayerName","\tld de, wOTTrademonSenderName","\tld bc, NAME_LENGTH","\tcall CopyBytes","\tld a, [wd003]","\tld hl, wOTPartySpecies","\tld b, 0","\tld c, a","\tadd hl, bc","\tld a, [hl]","\tld [wOTTrademonSpecies], a","\tld a, [wd003]","\tld hl, wOTPartyMonOT","\tcall SkipNames","\tld de, wOTTrademonOTName","\tld bc, NAME_LENGTH","\tcall CopyBytes","\tld hl, wOTPartyMon1ID","\tld a, [wd003]","\tcall GetPartyLocation","\tld a, [hli]","\tld [wOTTrademonID], a","\tld a, [hl]","\tld [wOTTrademonID + 1], a","\tld hl, wOTPartyMon1DVs","\tld a, [wd003]","\tcall GetPartyLocation","\tld a, [hli]","\tld [wOTTrademonDVs], a","\tld a, [hl]","\tld [wOTTrademonDVs + 1], a","\tld a, [wd003]","\tld hl, wOTPartyMon1Species","\tcall GetPartyLocation","\tld b, h","\tld c, l","\tfarcall GetCaughtGender","\tld a, c","\tld [wOTTrademonCaughtData], a","\tld a, [wd002]","\tld [wCurPartyMon], a","\tld hl, wPartySpecies","\tld b, 0","\tld c, a","\tadd hl, bc","\tld a, [hl]","\tld [wd002], a","\txor a ; REMOVE_PARTY","\tld [wPokemonWithdrawDepositParameter], a","\tcallfar RemoveMonFromPartyOrBox","\tld a, [wPartyCount]","\tdec a","\tld [wCurPartyMon], a","\tld a, TRUE","\tld [wForceEvolution], a","\tld a, [wd003]","\tpush af","\tld hl, wOTPartySpecies","\tld b, 0","\tld c, a","\tadd hl, bc","\tld a, [hl]","\tld [wd003], a","\tld c, 100","\tcall DelayFrames","\tcall ClearTilemap","\tcall LoadFontsBattleExtra","\tld b, SCGB_DIPLOMA","\tcall GetSGBLayout","\tldh a, [hSerialConnectionStatus]","\tcp USING_EXTERNAL_CLOCK","\tjr z, .player_2","\tpredef TradeAnimation","\tjr .done_animation","",".player_2","\tpredef TradeAnimationPlayer2","",".done_animation","\tpop af","\tld c, a","\tld [wCurPartyMon], a","\tld hl, wOTPartySpecies","\tld d, 0","\tld e, a","\tadd hl, de","\tld a, [hl]","\tld [wCurPartySpecies], a","\tld hl, wOTPartyMon1Species","\tld a, c","\tcall GetPartyLocation","\tld de, wTempMonSpecies","\tld bc, PARTYMON_STRUCT_LENGTH","\tcall CopyBytes","\tpredef AddTempmonToParty","\tld a, [wPartyCount]","\tdec a","\tld [wCurPartyMon], a","\tcallfar EvolvePokemon","\tcall ClearScreen","\tcall LoadTradeScreenBorder","\tcall SetTradeRoomBGPals","\tfarcall Link_WaitBGMap","\tld b, $1","\tpop af","\tld c, a","\tcp MEW","\tjr z, .loop","\tld a, [wCurPartySpecies]","\tcp MEW","\tjr z, .loop","\tld b, $2","\tld a, c","\tcp CELEBI","\tjr z, .loop","\tld a, [wCurPartySpecies]","\tcp CELEBI","\tjr z, .loop","\tld b, $0","",".loop","\tld a, b","\tld [wPlayerLinkAction], a","\tpush bc","\tcall Serial_PrintWaitingTextAndSyncAndExchangeNybble","\tpop bc","\tld a, [wLinkMode]","\tcp LINK_TIMECAPSULE","\tjr z, .save","\tld a, b","\tand a","\tjr z, .save","\tld a, [wOtherPlayerLinkAction]","\tcp b","\tjr nz, .loop","",".save","\tfarcall SaveAfterLinkTrade","\tfarcall StubbedTrainerRankings_Trades","\tfarcall BackupMobileEventIndex","\tld c, 40","\tcall DelayFrames","\thlcoord 0, 12","\tld b, 4","\tld c, 18","\tcall LinkTextboxAtHL","\thlcoord 1, 14","\tld de, String28ebd","\tcall PlaceString","\tfarcall Link_WaitBGMap","\tld c, 50","\tcall DelayFrames","\tld a, [wLinkMode]","\tcp LINK_TIMECAPSULE","\tjp z, Gen2ToGen1LinkComms","\tjp Gen2ToGen2LinkComms"],"name":"LinkTrade","file":"engine/link/link.asm","lineNo":1604,"address":103805,"addressUsedBy":[]}