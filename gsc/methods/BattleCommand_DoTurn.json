{"names":["BattleCommand_DoTurn"],"callingMethods":[],"methodsCalled":["BattleCommand_MoveDelay","CheckMimicUsed","CheckUserIsCharging","EndMoveEffect","GetBattleVar","GetPartyLocation","IsInArray","StdBattleTextbox"],"methodAddressesUsed":[],"varsSet":[],"varsUsed":["hBattleTurn","wBattleMode","wCurBattleMon","wCurEnemyMoveNum","wCurMoveNum","wCurOTMon"],"varAddressesUsed":["HasNoPPLeftText","wBattleMonPP","wEnemyMonMoves","wEnemyMonPP","wEnemySubStatus3","wEnemyTurnsTaken","wOTPartyMon1PP","wPartyMon1PP","wPlayerSubStatus3","wPlayerTurnsTaken","wWildMonMoves","wWildMonPP"],"constantsUsed":["BATTLE_VARS_MOVE","BATTLE_VARS_MOVE_EFFECT"],"lines":["BattleCommand_DoTurn:","\tcall CheckUserIsCharging","\tret nz","","\tld hl, wBattleMonPP","\tld de, wPlayerSubStatus3","\tld bc, wPlayerTurnsTaken","","\tldh a, [hBattleTurn]","\tand a","\tjr z, .proceed","","\tld hl, wEnemyMonPP","\tld de, wEnemySubStatus3","\tld bc, wEnemyTurnsTaken","",".proceed","","; If we\u0027ve gotten this far, this counts as a turn.","\tld a, [bc]","\tinc a","\tld [bc], a","","\tld a, BATTLE_VARS_MOVE","\tcall GetBattleVar","\tcp STRUGGLE","\tret z","","\tld a, [de]","\tand 1 \u003c\u003c SUBSTATUS_IN_LOOP | 1 \u003c\u003c SUBSTATUS_RAMPAGE | 1 \u003c\u003c SUBSTATUS_BIDE","\tret nz","","\tcall .consume_pp","\tld a, b","\tand a","\tjp nz, EndMoveEffect","","\t; SubStatus5","\tinc de","\tinc de","","\tld a, [de]","\tbit SUBSTATUS_TRANSFORMED, a","\tret nz","","\tldh a, [hBattleTurn]","\tand a","","\tld hl, wPartyMon1PP","\tld a, [wCurBattleMon]","\tjr z, .player","","; mimic this part entirely if wildbattle","\tld a, [wBattleMode]","\tdec a","\tjr z, .wild","","\tld hl, wOTPartyMon1PP","\tld a, [wCurOTMon]","",".player","\tcall GetPartyLocation","\tpush hl","\tcall CheckMimicUsed","\tpop hl","\tret c","",".consume_pp","\tldh a, [hBattleTurn]","\tand a","\tld a, [wCurMoveNum]","\tjr z, .okay","\tld a, [wCurEnemyMoveNum]","",".okay","\tld c, a","\tld b, 0","\tadd hl, bc","\tld a, [hl]","\tand PP_MASK","\tjr z, .out_of_pp","\tdec [hl]","\tld b, 0","\tret","",".wild","\tld hl, wEnemyMonMoves","\tld a, [wCurEnemyMoveNum]","\tld c, a","\tld b, 0","\tadd hl, bc","\tld a, [hl]","\tcp MIMIC","\tjr z, .mimic","\tld hl, wWildMonMoves","\tadd hl, bc","\tld a, [hl]","\tcp MIMIC","\tret z","",".mimic","\tld hl, wWildMonPP","\tcall .consume_pp","\tret","",".out_of_pp","\tcall BattleCommand_MoveDelay","; get move effect","\tld a, BATTLE_VARS_MOVE_EFFECT","\tcall GetBattleVar","; continuous?","\tld hl, .continuousmoves","\tld de, 1","\tcall IsInArray","","; \u0027has no pp left for [move]\u0027","\tld hl, HasNoPPLeftText","\tjr c, .print","; \u0027but no pp is left for the move\u0027","\tld hl, NoPPLeftText",".print","\tcall StdBattleTextbox","\tld b, 1","\tret","",".continuousmoves","\tdb EFFECT_RAZOR_WIND","\tdb EFFECT_SKY_ATTACK","\tdb EFFECT_SKULL_BASH","\tdb EFFECT_SOLARBEAM","\tdb EFFECT_FLY","\tdb EFFECT_ROLLOUT","\tdb EFFECT_BIDE","\tdb EFFECT_RAMPAGE","\tdb -1"],"name":"BattleCommand_DoTurn","file":"engine/battle/effect_commands.asm","lineNo":959,"address":117021,"addressUsedBy":[]}