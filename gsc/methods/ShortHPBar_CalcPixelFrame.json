{"names":["ShortHPBar_CalcPixelFrame"],"callingMethods":["ShortAnim_UpdateVariables"],"methodsCalled":["AddNTimes"],"methodAddressesUsed":[],"varsSet":["wCurHPAnimOldHP"],"varsUsed":["wCurHPAnimHighHP","wCurHPAnimLowHP","wCurHPAnimMaxHP","wCurHPBarPixels"],"varAddressesUsed":[],"constantsUsed":[],"lines":["ShortHPBar_CalcPixelFrame:","\tld a, [wCurHPAnimMaxHP]","\tld c, a","\tld b, 0","\tld hl, 0","\tld a, [wCurHPBarPixels]","\tcp HP_BAR_LENGTH_PX","\tjr nc, .return_max","\tand a","\tjr z, .return_zero","\tcall AddNTimes","","\tld b, 0","; This routine is buggy. If [wCurHPAnimMaxHP] * [wCurHPBarPixels] is","; divisible by HP_BAR_LENGTH_PX, the loop runs one extra time.","; To fix, uncomment the line below.",".loop","\tld a, l","\tsub HP_BAR_LENGTH_PX","\tld l, a","\tld a, h","\tsbc $0","\tld h, a","\t; jr z, .done","\tjr c, .done","\tinc b","\tjr .loop","",".done","\tpush bc","\tld bc, $80","\tadd hl, bc","\tpop bc","\tld a, l","\tsub HP_BAR_LENGTH_PX","\tld l, a","\tld a, h","\tsbc $0","\tld h, a","\tjr c, .no_carry","\tinc b",".no_carry","\tld a, [wCurHPAnimLowHP]","\tcp b","\tjr nc, .finish","\tld a, [wCurHPAnimHighHP]","\tcp b","\tjr c, .finish","\tld a, b",".finish","\tld [wCurHPAnimOldHP], a","\tret","",".return_zero","\txor a","\tld [wCurHPAnimOldHP], a","\tret","",".return_max","\tld a, [wCurHPAnimMaxHP]","\tld [wCurHPAnimOldHP], a","\tret"],"name":"ShortHPBar_CalcPixelFrame","file":"engine/battle/anim_hp_bar.asm","lineNo":363,"address":76836,"addressUsedBy":[]}