{"names":["GetRelativeFacing"],"callingMethods":[],"methodsCalled":["GetMapObject","GetObjectStruct"],"methodAddressesUsed":[],"varsSet":[],"varsUsed":[],"varAddressesUsed":[],"constantsUsed":["DOWN","LEFT","MAPOBJECT_OBJECT_STRUCT_ID","OBJECT_NEXT_MAP_X","OBJECT_NEXT_MAP_Y","RIGHT","UP"],"lines":["GetRelativeFacing::","; Determines which way map object e would have to turn to face map object d.  Returns carry if it\u0027s impossible for whatever reason.","\tld a, d","\tcall GetMapObject","\tld hl, MAPOBJECT_OBJECT_STRUCT_ID","\tadd hl, bc","\tld a, [hl]","\tcp NUM_OBJECT_STRUCTS","\tjr nc, .carry","\tld d, a","\tld a, e","\tcall GetMapObject","\tld hl, MAPOBJECT_OBJECT_STRUCT_ID","\tadd hl, bc","\tld a, [hl]","\tcp NUM_OBJECT_STRUCTS","\tjr nc, .carry","\tld e, a","\tcall .GetFacing_e_relativeto_d","\tret","",".carry","\tscf","\tret","",".GetFacing_e_relativeto_d:","; Determines which way object e would have to turn to face object d.  Returns carry if it\u0027s impossible.","; load the coordinates of object d into bc","\tld a, d","\tcall GetObjectStruct","\tld hl, OBJECT_NEXT_MAP_X","\tadd hl, bc","\tld a, [hl]","\tld hl, OBJECT_NEXT_MAP_Y","\tadd hl, bc","\tld c, [hl]","\tld b, a","\tpush bc","; load the coordinates of object e into de","\tld a, e","\tcall GetObjectStruct","\tld hl, OBJECT_NEXT_MAP_X","\tadd hl, bc","\tld d, [hl]","\tld hl, OBJECT_NEXT_MAP_Y","\tadd hl, bc","\tld e, [hl]","\tpop bc","; |x1 - x2|","\tld a, b","\tsub d","\tjr z, .same_x_1","\tjr nc, .b_right_of_d_1","\tcpl","\tinc a","",".b_right_of_d_1","; |y1 - y2|","\tld h, a","\tld a, c","\tsub e","\tjr z, .same_y_1","\tjr nc, .c_below_e_1","\tcpl","\tinc a","",".c_below_e_1","; |y1 - y2| - |x1 - x2|","\tsub h","\tjr c, .same_y_1","",".same_x_1","; compare the y coordinates","\tld a, c","\tcp e","\tjr z, .same_x_and_y","\tjr c, .c_directly_below_e","; c directly above e","\tld d, DOWN","\tand a","\tret","",".c_directly_below_e","\tld d, UP","\tand a","\tret","",".same_y_1","\tld a, b","\tcp d","\tjr z, .same_x_and_y","\tjr c, .b_directly_right_of_d","; b directly left of d","\tld d, RIGHT","\tand a","\tret","",".b_directly_right_of_d","\tld d, LEFT","\tand a","\tret","",".same_x_and_y","\tscf","\tret"],"name":"GetRelativeFacing","file":"engine/overworld/player_object.asm","lineNo":694,"address":67038,"addressUsedBy":[]}